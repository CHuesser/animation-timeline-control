{"version":3,"file":"animation-timeline.js","mappings":"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","sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///webpack/runtime/define property getters","webpack:///webpack/runtime/hasOwnProperty shorthand","webpack:///webpack/runtime/make namespace object","webpack:///./src/timelineEventsEmitter.ts","webpack:///./src/enums/timelineKeyframeShape.ts","webpack:///./src/utils/timelineStyleUtils.ts","webpack:///./src/utils/timelineUtils.ts","webpack:///./src/utils/events/timelineBaseEvent.ts","webpack:///./src/utils/events/timelineKeyframeChangedEvent.ts","webpack:///./src/enums/timelineEventSource.ts","webpack:///./src/utils/events/timelineTimeChangedEvent.ts","webpack:///./src/utils/events/timelineSelectedEvent.ts","webpack:///./src/utils/events/timelineClickEvent.ts","webpack:///./src/utils/events/timelineDragEvent.ts","webpack:///./src/enums/timelineInteractionMode.ts","webpack:///./src/enums/timelineElementType.ts","webpack:///./src/enums/timelineCursorType.ts","webpack:///./src/enums/timelineCapShape.ts","webpack:///./src/enums/timelineSelectionMode.ts","webpack:///./src/enums/timelineEvents.ts","webpack:///./src/settings/defaults.ts","webpack:///./src/timeline.ts","webpack:///./src/animation-timeline.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"timelineModule\"] = factory();\n\telse\n\t\troot[\"timelineModule\"] = factory();\n})(self, () => {\nreturn ","// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/* eslint-disable  @typescript-eslint/no-explicit-any */\ninterface Event {\n  topic: string;\n  callback: (args: any) => void;\n}\n\nexport class TimelineEventsEmitter {\n  protected _subscriptions: Array<Event> = [];\n\n  // on event.\n  on(topic: string, callback: (args: any) => void): void {\n    if (!callback) {\n      return;\n    }\n\n    this._subscriptions.push({\n      topic: topic,\n      callback: callback,\n    });\n  }\n  /**\n   * Remove an event from the subscriptions list.\n   */\n  off(topic: string, callback: (args: any) => void): void {\n    this._subscriptions = this._subscriptions.filter((event) => {\n      return event && event.callback != callback && event.topic != topic;\n    });\n  }\n\n  /**\n   * Unsubscribe all\n   */\n  offAll(): void {\n    this._subscriptions.length = 0;\n  }\n\n  // emit event.\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  emit(topic: string, args: any): void {\n    this._subscriptions.forEach((event) => {\n      if (event && event.topic == topic && event.callback) {\n        event.callback(args);\n      }\n    });\n  }\n}\n","export enum TimelineKeyframeShape {\n  None = 'none',\n  Rhomb = 'rhomb',\n  Circle = 'circle',\n  Rect = 'rect',\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { TimelineRow } from '../timelineRow';\nimport { TimelineOptions } from '../settings/timelineOptions';\nimport { TimelineRowStyle } from '../settings/styles/timelineRowStyle';\nimport { TimelineKeyframeStyle } from '../settings/styles/timelineKeyframeStyle';\nimport { TimelineKeyframeShape } from '../enums/timelineKeyframeShape';\n\nexport class TimelineStyleUtils {\n  /**\n   * Get keyframe style from a keyframe, than from a row, than from a global settings.\n   * @param keyframe keyframe to get style for.\n   * @param row keyframe row.\n   * @param propertyName property to get.\n   * @param defaultValue default value to return\n   * @param reverseOrder reverse styling order: global, row, keyframe\n   */\n  static getKeyframeStyle<T>(\n    keyframeStyle: TimelineKeyframeStyle | null,\n    rowStyle: TimelineRow | null,\n    options: TimelineOptions | null,\n    propertyName: string,\n    defaultValue?: T,\n    reverseOrder = false,\n  ): T {\n    // Don't spawn new array for the normal order.\n    let styles: Array<any> | null = null;\n    if (keyframeStyle) {\n      const style: any = keyframeStyle;\n      if (style[propertyName] !== undefined) {\n        const value = style[propertyName];\n        if (!reverseOrder) {\n          return value;\n        }\n        styles = styles || [];\n        styles.push(value);\n      }\n    }\n\n    if (rowStyle && rowStyle.keyframesStyle) {\n      const style: any = rowStyle.keyframesStyle;\n      if (style[propertyName] !== undefined) {\n        const value = style[propertyName];\n        if (!reverseOrder) {\n          return value;\n        }\n        styles = styles || [];\n        styles.push(value);\n      }\n    }\n    const globalRowStyle = options ? options.rowsStyle : null;\n    if (globalRowStyle && globalRowStyle.keyframesStyle) {\n      const style: any = globalRowStyle.keyframesStyle;\n      if (style[propertyName] !== undefined) {\n        const value = style[propertyName];\n        if (!reverseOrder) {\n          return value;\n        }\n        styles = styles || [];\n        styles.push(value);\n      }\n    }\n\n    return reverseOrder && styles && styles.length > 0 ? styles[styles.length - 1] : defaultValue;\n  }\n\n  /**\n   * Get row style from default settings or overrides by a row settings.\n   */\n  static getRowStyle<T>(rowStyle: TimelineRowStyle, options: TimelineOptions | null, propertyName: string, defaultValue?: T, reverseOrder = false): T | undefined {\n    // Don't spawn new array for the normal order.\n    let styles: Array<any> = null;\n    if (rowStyle) {\n      const style: any = rowStyle;\n      if (style[propertyName] !== undefined) {\n        const results = style[propertyName] as T;\n        if (!reverseOrder) {\n          return results;\n        }\n        styles = styles || [];\n        styles.push(results);\n      }\n    }\n    const globalRowStyle = options ? options.rowsStyle : null;\n    if (globalRowStyle) {\n      const style: any = globalRowStyle;\n      if (style[propertyName] !== undefined) {\n        const results = style[propertyName] as T;\n        if (!reverseOrder) {\n          return results;\n        }\n\n        styles = styles || [];\n        styles.push(results);\n      }\n    }\n\n    return reverseOrder && styles && styles.length > 0 ? styles[styles.length - 1] : defaultValue;\n  }\n\n  static keyframeShape(keyframe: TimelineKeyframeStyle | null, rowStyle: TimelineRowStyle | null, options: TimelineOptions | null): TimelineKeyframeShape {\n    const shape = TimelineStyleUtils.getKeyframeStyle<TimelineKeyframeShape>(keyframe, rowStyle, options, 'shape', TimelineKeyframeShape.Rhomb);\n    return shape;\n  }\n  static keyframeFillColor(keyframe: TimelineKeyframeStyle | null, rowStyle: TimelineRowStyle | null, options: TimelineOptions | null): string {\n    const color = TimelineStyleUtils.getKeyframeStyle<string>(keyframe, rowStyle, options, 'fillColor', 'DarkOrange');\n    return color;\n  }\n  static keyframeSelectedFillColor(keyframe: TimelineKeyframeStyle | null, rowStyle: TimelineRowStyle | null, options: TimelineOptions | null): string {\n    const color = TimelineStyleUtils.getKeyframeStyle<string>(keyframe, rowStyle, options, 'selectedFillColor', 'red');\n    return color;\n  }\n\n  static keyframeStrokeThickness(keyframe: TimelineKeyframeStyle | null, rowStyle: TimelineRowStyle | null, options: TimelineOptions | null): number {\n    return TimelineStyleUtils.getKeyframeStyle<number>(keyframe, rowStyle, options, 'strokeThickness', 0.2, false);\n  }\n\n  static keyframeStrokeColor(keyframe: TimelineKeyframeStyle | null, rowStyle: TimelineRowStyle | null, options: TimelineOptions | null): string {\n    return TimelineStyleUtils.getKeyframeStyle<string>(keyframe, rowStyle, options, 'strokeColor', 'Black', false);\n  }\n  static keyframeSelectedStrokeColor(keyframe: TimelineKeyframeStyle | null, rowStyle: TimelineRowStyle | null, options: TimelineOptions | null): string {\n    return TimelineStyleUtils.getKeyframeStyle<string>(keyframe, rowStyle, options, 'selectedStrokeColor', 'Black', false);\n  }\n  /**\n   * Get current row height from styling\n   */\n  static getRowHeight(rowStyle: TimelineRowStyle, options: TimelineOptions): number {\n    return TimelineStyleUtils.getRowStyle<number>(rowStyle, options, 'height', 24);\n  }\n  static rowGroupHeight(rowStyle: TimelineRowStyle, options: TimelineOptions): number | string {\n    return TimelineStyleUtils.getRowStyle<number | string>(rowStyle, options, 'groupHeight', 'auto');\n  }\n  static groupFillColor(rowStyle: TimelineRowStyle, options: TimelineOptions): string | null {\n    return TimelineStyleUtils.getRowStyle<string>(rowStyle, options, 'groupFillColor');\n  }\n  static getRowMarginBottom(rowStyle: TimelineRowStyle, options: TimelineOptions): number {\n    return TimelineStyleUtils.getRowStyle<number>(rowStyle, options, 'marginBottom', 0);\n  }\n  static getRowFillColor(rowStyle: TimelineRowStyle, options: TimelineOptions): string {\n    return TimelineStyleUtils.getRowStyle<string>(rowStyle, options, 'fillColor', '#252526');\n  }\n  static headerHeight(options: TimelineOptions | null): number {\n    return options ? options.headerHeight : 0 || 30;\n  }\n  static keyframeDraggable(keyframe: TimelineKeyframeStyle | null, rowStyle: TimelineRowStyle | null, options: TimelineOptions | null, defaultValue = true): boolean {\n    return TimelineStyleUtils.getKeyframeStyle<boolean>(keyframe, rowStyle, options, 'draggable', defaultValue, false);\n  }\n\n  static groupDraggable(rowStyle: TimelineRowStyle, options: TimelineOptions, defaultValue = true): boolean {\n    return TimelineStyleUtils.getRowStyle<boolean>(rowStyle, options, 'groupDraggable', defaultValue, false);\n  }\n}\n","import { TimelineRanged } from '../timelineRanged';\n\nconst denominators = [1, 2, 5, 10];\nexport class TimelineUtils {\n  static drawLine(ctx: CanvasRenderingContext2D, x1: number, y1: number, x2: number, y2: number): void {\n    ctx.moveTo(x1, y1);\n    ctx.lineTo(x2, y2);\n  }\n  /**\n   * Check is valid number.\n   */\n  static isNumber(val?: number): boolean {\n    if (typeof val === 'number' && !isNaN(val) && Number.isFinite(val)) {\n      return true;\n    }\n\n    return false;\n  }\n  static deleteElement<T>(array: Array<T>, element: T): Array<T> {\n    const index: number = array.indexOf(element);\n    if (index !== -1) {\n      return array.splice(index, 1);\n    }\n    return array;\n  }\n\n  /**\n   * Check rectangle overlap.\n   */\n  static isOverlap(x: number, y: number, rectangle: DOMRect): boolean {\n    if (!rectangle) {\n      return false;\n    }\n\n    if (rectangle.x <= x && rectangle.x + rectangle.width >= x && rectangle.y <= y && rectangle.y + rectangle.height >= y) {\n      return true;\n    }\n\n    return false;\n  }\n  /**\n   * Find beautiful step for the header line gauge.\n   */\n  static findGoodStep(originalStep: number, divisionCheck = 0): number {\n    if (originalStep <= 0 || isNaN(originalStep) || !Number.isFinite(originalStep)) {\n      return originalStep;\n    }\n    let step = originalStep;\n    let lastDistance = null;\n    const pow = TimelineUtils.getPowArgument(originalStep);\n    for (let i = 0; i < denominators.length; i++) {\n      const denominator = denominators[i];\n      const calculatedStep = denominator * Math.pow(10, pow);\n      if (divisionCheck && divisionCheck % calculatedStep != 0) {\n        continue;\n      }\n      const distance = TimelineUtils.getDistance(originalStep, calculatedStep);\n\n      if (distance == 0 || (distance <= 0.1 && pow > 0)) {\n        lastDistance = distance;\n        step = calculatedStep;\n        break;\n      } else if (!lastDistance || lastDistance > distance) {\n        lastDistance = distance;\n        step = calculatedStep;\n      }\n    }\n\n    return step;\n  }\n  /**\n   * Keep value in min, max bounds.\n   */\n  static keepInBounds(value: number, min: number | undefined = null, max: number | undefined = null): number {\n    if (TimelineUtils.isNumber(value)) {\n      if (TimelineUtils.isNumber(min)) {\n        value = Math.max(value, min);\n      }\n      if (TimelineUtils.isNumber(max)) {\n        value = Math.min(value, max);\n      }\n    }\n\n    return value;\n  }\n  static setMinMax(to: TimelineRanged, from: TimelineRanged, shrink = false): TimelineRanged {\n    if (!from || !to) {\n      return to;\n    }\n    const fromMin = Math.min(from.getMin ? from.getMin() : from.min, from.min);\n    const toMin = Math.min(to.getMin ? to.getMin() : to.min, to.min);\n    const isFromMinNumber = TimelineUtils.isNumber(fromMin);\n    const isToMinNumber = TimelineUtils.isNumber(toMin);\n    // get absolute min and max bounds:\n    if (isFromMinNumber && isToMinNumber) {\n      to.min = shrink ? Math.min(fromMin, toMin) : Math.max(fromMin, toMin);\n    } else if (isFromMinNumber) {\n      to.min = fromMin;\n    }\n\n    const fromMax = Math.min(from.getMax ? from.getMax() : from.max, from.max);\n    const toMax = Math.min(to.getMax ? to.getMax() : to.max, to.max);\n    const isFromMaxNumber = TimelineUtils.isNumber(fromMax);\n    const isToMaxNumber = TimelineUtils.isNumber(toMax);\n    if (isFromMaxNumber && isToMaxNumber) {\n      to.max = shrink ? Math.max(fromMax, toMax) : Math.min(fromMax, toMax);\n    } else if (isFromMaxNumber) {\n      to.max = fromMax;\n    }\n\n    return to;\n  }\n  static isRectOverlap(rect: DOMRect, rect2: DOMRect): boolean {\n    if (!rect || !rect2) {\n      console.log('Rectangles cannot be empty');\n      return false;\n    }\n\n    // If one rectangle is on left side of other\n    if (rect.x > rect2.x + rect2.width || rect2.x > rect.x + rect.width) {\n      return true;\n    }\n\n    // If one rectangle is above other\n    if (rect.y < rect2.y + rect2.height || rect2.y < rect.y + rect.height) {\n      return true;\n    }\n    return false;\n  }\n\n  static getDistance(x1: number, y1: number, x2?: number, y2?: number): number {\n    if (x2 != undefined && y2 != undefined) {\n      return Math.sqrt(Math.pow(x1 - x2, 2) + Math.pow(y1 - y2, 2));\n    } else {\n      return Math.abs(x1 - y1);\n    }\n  }\n  static sign(p: number): number {\n    return p >= 0 ? 1 : -1;\n  }\n\n  static clearBrowserSelection(): void {\n    if (!window) {\n      return;\n    }\n    if (window.getSelection) {\n      window.getSelection().removeAllRanges();\n    } else {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      const doc: any = window.document;\n      if (doc.selection) {\n        doc.selection.empty();\n      }\n    }\n  }\n  static getPowArgument(toCheck: number): number {\n    if (!toCheck || toCheck === 0 || !isFinite(toCheck)) {\n      return 1;\n    }\n    // some optimization for numbers:\n    if (toCheck >= 10 && toCheck < 100) {\n      return 1;\n    } else if (toCheck >= 100 && toCheck < 1000) {\n      return 2;\n    } else if (toCheck >= 1000 && toCheck < 10000) {\n      return 3;\n    }\n\n    toCheck = Math.abs(toCheck);\n    let category = 0;\n    const s = this.sign(toCheck);\n    if (toCheck > 1) {\n      while (toCheck >= 1) {\n        toCheck = Math.floor(toCheck / 10.0);\n        category++;\n      }\n\n      return s * category - 1;\n    } else if (toCheck > 0.0) {\n      // Get number of zeros before the number.\n      const zerosCount = Math.floor(Math.log(toCheck) / Math.log(10) + 1) - 1;\n      return zerosCount;\n    } else {\n      return 1;\n    }\n  }\n}\n","export class TimelineBaseEvent {\n  private _prevented = false;\n  /**\n   * Prevent default click logic.\n   */\n  preventDefault(): void {\n    this._prevented = true;\n  }\n\n  isPrevented(): boolean {\n    return this._prevented;\n  }\n}\n","import { TimelineBaseEvent } from './timelineBaseEvent';\nimport { TimelineElement } from '../timelineElement';\nimport { TimelineEventSource } from '../../enums/timelineEventSource';\n\nexport class TimelineKeyframeChangedEvent extends TimelineBaseEvent {\n  /**\n   * Value to be used.\n   */\n  val: number;\n  /**\n   * Previous value.\n   */\n  prevVal: number;\n  /**\n   * Target element\n   */\n  target: TimelineElement;\n  /**\n   * Event source.\n   */\n  source: TimelineEventSource;\n}\n","export enum TimelineEventSource {\n  User = 'user',\n  Programmatically = 'programmatically',\n  SetTimeMethod = 'setTimeMethod',\n}\n","import { TimelineBaseEvent } from './timelineBaseEvent';\nimport { TimelineEventSource } from '../../enums/timelineEventSource';\n\nexport class TimelineTimeChangedEvent extends TimelineBaseEvent {\n  /**\n   * new value to be set.\n   */\n  val = 0;\n  /**\n   * previous value.\n   */\n  prevVal = 0;\n  source: TimelineEventSource = TimelineEventSource.User;\n}\n","import { TimelineKeyframe } from '../../timelineKeyframe';\nimport { TimelineBaseEvent } from './timelineBaseEvent';\n\nexport class TimelineSelectedEvent extends TimelineBaseEvent {\n  selected: Array<TimelineKeyframe> = [];\n  changed: Array<TimelineKeyframe> = [];\n}\n","import { TimelineElement } from '../timelineElement';\nimport { TimelineBaseEvent } from './timelineBaseEvent';\nimport { TimelineValues } from '../timelineValues';\n\nexport class TimelineClickEvent extends TimelineBaseEvent implements TimelineValues {\n  args: MouseEvent;\n  /**\n   * Clicked screen position.\n   */\n  pos: DOMPoint;\n\n  /**\n   * Elements list under the click\n   */\n  elements: Array<TimelineElement>;\n  /**\n   * Target element\n   */\n  target: TimelineElement;\n  /**\n   * Value to be used.\n   */\n  val: number;\n  /**\n   * Snapped value.\n   */\n  snapVal: number;\n  /**\n   * Unsnapped original value.\n   */\n  originalVal: number;\n}\n","import { TimelineValues } from '../timelineValues';\nimport { TimelineBaseEvent } from './timelineBaseEvent';\nimport { TimelineElementDragState } from '../timelineElementDragState';\n\nexport class TimelineDragEvent extends TimelineBaseEvent implements TimelineValues {\n  args: MouseEvent;\n  /**\n   * Clicked screen position.\n   */\n  pos: DOMPoint;\n\n  /**\n   * Elements to be dragged as a group.\n   */\n  elements: Array<TimelineElementDragState>;\n  /**\n   * Target element\n   */\n  target: TimelineElementDragState;\n  /**\n   * Value to be used.\n   */\n  val: number;\n\n  /**\n   * prev value.\n   */\n  prevVal: number;\n\n  /**\n   * Snapped value.\n   */\n  snapVal: number;\n  /**\n   * Unsnapped original value.\n   */\n  originalVal: number;\n}\n","export enum TimelineInteractionMode {\n  /**\n   * Selection tool\n   */\n  Selection = 'selection',\n  /**\n   * Pan tool\n   */\n  Pan = 'pan',\n  /**\n   * Zoom tool.\n   */\n  Zoom = 'zoom',\n}\n","export enum TimelineElementType {\n  /**\n   * Timeline\n   */\n  Timeline = 'timeline',\n  /**\n   * Keyframes\n   */\n  Keyframe = 'keyframe',\n  /**\n   * Keyframes group\n   */\n  Group = 'group',\n  /**\n   * Row\n   */\n  Row = 'row',\n}\n","export enum TimelineCursorType {\n  Alias = 'alias',\n  AllScroll = 'all-scroll',\n  Auto = 'auto',\n  Cell = 'cell',\n  ContextMenu = 'context-menu',\n  ColResize = 'col-resize',\n  Copy = 'copy',\n  Crosshair = 'crosshair',\n  Default = 'default',\n  EResize = 'e-resize',\n  EWResize = 'ew-resize',\n  Grab = 'grab',\n  Grabbing = 'grabbing',\n  Help = 'help',\n  Move = 'move',\n  NResize = 'n-resize',\n  NEResize = 'ne-resize',\n  NESWResize = 'nesw-resize',\n  NSResize = 'ns-resize',\n  NWResize = 'nw-resize',\n  NWSEResize = 'nwse-resize',\n  NoDrop = 'no-drop',\n  None = 'none',\n  NotAllowed = 'not-allowed',\n  Pointer = 'pointer',\n  Progress = 'progress',\n  RowResize = 'row-resize',\n  SResize = 's-resize',\n  SEResize = 'se-resize',\n  SWResize = 'sw-resize',\n  Text = 'text',\n  WResize = 'w-resize',\n  Wait = 'wait',\n  ZoomIn = 'zoom-in',\n  ZoomOut = 'zoom-out',\n}\n","export enum TimelineCapShape {\n  None = 'none',\n  Triangle = 'triangle',\n  Rect = 'rect',\n}\n","/**\n * Timeline selection mode.\n */\nexport enum TimelineSelectionMode {\n  /**\n   * Select new items. deselect changed.\n   */\n  Normal = 'normal',\n  /**\n   * Append current selection.\n   */\n  Append = 'append',\n  /**\n   * Revert selection of a specified nodes.\n   */\n  Revert = 'revert',\n}\n","export enum TimelineEvents {\n  Selected = 'selected',\n  TimeChanged = 'timechanged',\n  KeyframeChanged = 'keyframeChanged',\n  DragStarted = 'dragStarted',\n  Drag = 'drag',\n  DragFinished = 'dragFinished',\n  Scroll = 'scroll',\n  DoubleClick = 'doubleClick',\n  MouseDown = 'mouseDown',\n}\n","import { TimelineConsts } from './timelineConsts';\nimport { TimelineCapShape } from '../enums/timelineCapShape';\nimport { TimelineStyle } from './styles/timelineStyle';\nimport { TimelineOptions } from './timelineOptions';\nimport { TimelineKeyframeShape } from '../enums/timelineKeyframeShape';\nimport { TimelineKeyframeStyle } from './styles/timelineKeyframeStyle';\nimport { TimelineRowStyle } from './styles/timelineRowStyle';\n\nexport const defaultTimelineStyle = {\n  width: 2,\n  marginTop: 15,\n  capWidth: 4,\n  capHeight: 10,\n  /**\n   * Draw timeline rectangular cap.\n   */\n  capType: TimelineCapShape.Rect,\n  strokeColor: 'DarkOrange',\n  fillColor: 'DarkOrange',\n} as TimelineStyle;\n\nexport const defaultTimelineKeyframeStyle = {\n  /**\n   * keyframe fill color.\n   */\n  fillColor: 'DarkOrange',\n  shape: TimelineKeyframeShape.Rhomb,\n  /**\n   * Selected keyframe fill color.\n   */\n  selectedFillColor: 'red',\n  strokeColor: 'black',\n  selectedStrokeColor: 'black',\n  strokeThickness: 0.2,\n  draggable: true,\n} as TimelineKeyframeStyle;\n\nexport const defaultTimelineRowStyle = {\n  /**\n   * Row height in pixels.\n   */\n  height: 24,\n  marginBottom: 2,\n  fillColor: '#252526',\n  /**\n   * Keyframes group color\n   */\n  groupFillColor: '#094771',\n  groupHeight: 'auto',\n  keyframesStyle: defaultTimelineKeyframeStyle,\n} as TimelineRowStyle;\n\nexport const defaultTimelineOptions = {\n  /**\n   *  Snap all selected keyframes as a bundle during the drag.\n   */\n  snapAllKeyframesOnMove: false,\n\n  /**\n   * Check whether snapping is enabled.\n   */\n  snapEnabled: true,\n\n  timelineStyle: defaultTimelineStyle,\n  /**\n   * approximate step for the timeline in pixels for 1 second\n   */\n  stepPx: 120,\n  /**\n   * Number of units that should fit into one stepPx. (1 second by a default)\n   */\n  stepVal: 1000,\n  stepSmallPx: 30,\n  /**\n   * Snap step in units. from 0 to stepVal\n   */\n  snapStep: 200,\n  /**\n   * additional left margin in pixels to start the line gauge from.\n   */\n  leftMargin: 25,\n  headerFillColor: '#101011',\n  fillColor: '#101011',\n\n  labelsColor: '#D5D5D5',\n  /**\n   * Header gauge tick color.\n   */\n  tickColor: '#D5D5D5',\n  /**\n   * Selection rectangle color.\n   */\n  selectionColor: 'White',\n\n  /**\n   * Default rows style.\n   * Can be overridden by setting style individually for each row.\n   */\n  rowsStyle: defaultTimelineRowStyle,\n  /**\n   * Header height in pixels\n   */\n  headerHeight: 30,\n  font: '11px sans-serif',\n  /**\n   * Default zoom level = 1. where screen pixels are equals to the corresponding stepVal stepPx.\n   */\n  zoom: 1,\n  /**\n   * Default zoom speed.\n   */\n  zoomSpeed: 0.1,\n  /**\n   * Max zoom value.\n   */\n  zoomMin: 0.1,\n  /**\n   * Min zoom value.\n   */\n  zoomMax: 8,\n  /**\n   * Set this to true in a MAC OS environment: The Meta key will be used instead of the Ctrl key.\n   */\n  controlKeyIsMetaKey: false,\n  /**\n   * Access the scroll container via this class for e.g. scroll bar styling.\n   */\n  scrollContainerClass: 'scroll-container',\n  /**\n   * keyframes group is draggable.\n   */\n  groupsDraggable: true,\n  /**\n   * keyframes group is draggable.\n   */\n  keyframesDraggable: true,\n  min: 0,\n  max: Number.MAX_VALUE,\n} as TimelineOptions;\n\nexport const defaultTimelineConsts: TimelineConsts = {\n  /**\n   * Auto pan speed.\n   */\n  autoPanSpeed: 50,\n  /**\n   * scroll speed when mouse drag is used (from 0 to 1)\n   */\n  scrollByDragSpeed: 0.12,\n  /**\n   * Determine whether item was clicked.\n   */\n  clickDetectionMs: 120,\n  /**\n   * Timeout to detect double click.\n   */\n  doubleClickTimeoutMs: 400,\n  /**\n   * Time in ms used to refresh scrollbars when pan is finished.\n   */\n  scrollFinishedTimeoutMs: 500,\n  /**\n   * Auto pan padding\n   */\n  autoPanByScrollPadding: 10,\n  /**\n   * Click threshold\n   */\n  clickThreshold: 3,\n} as TimelineConsts;\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n// bundle entry point\n\nimport { TimelineModel } from './timelineModel';\nimport { TimelineRow } from './timelineRow';\nimport { TimelineKeyframe } from './timelineKeyframe';\nimport { TimelineEventsEmitter } from './timelineEventsEmitter';\nimport { TimelineConsts } from './settings/timelineConsts';\nimport { TimelineRanged } from './timelineRanged';\n\n// @public styles\nimport { TimelineOptions } from './settings/timelineOptions';\n\nimport { TimelineStyleUtils } from './utils/timelineStyleUtils';\nimport { TimelineUtils } from './utils/timelineUtils';\nimport { TimelineElement } from './utils/timelineElement';\n\n// @private helper containers.\nimport { TimelineCutBoundsRectResults } from './utils/timelineCutBoundsRectResults';\nimport { TimelineSelectionResults } from './utils/timelineSelectionResults';\nimport { TimelineMouseData } from './utils/timelineMouseData';\nimport { TimelineElementDragState } from './utils/timelineElementDragState';\nimport { TimelineDraggableData } from './utils/timelineDraggableData';\n\n// @private virtual model\nimport { TimelineModelCalcResults } from './utils/timelineModelCalcResults';\nimport { TimelineCalculatedRow } from './utils/timelineCalculatedRow';\nimport { TimelineCalculatedGroup } from './utils/timelineCalculatedGroup';\nimport { TimelineCalculatedKeyframe } from './utils/timelineCalculatedKeyframe';\n\n// @public events\nimport { TimelineKeyframeChangedEvent } from './utils/events/timelineKeyframeChangedEvent';\nimport { TimelineTimeChangedEvent } from './utils/events/timelineTimeChangedEvent';\nimport { TimelineSelectedEvent } from './utils/events/timelineSelectedEvent';\nimport { TimelineScrollEvent } from './utils/events/timelineScrollEvent';\nimport { TimelineClickEvent } from './utils/events/timelineClickEvent';\nimport { TimelineDragEvent } from './utils/events/timelineDragEvent';\n\n// @public enums\nimport { TimelineKeyframeShape } from './enums/timelineKeyframeShape';\nimport { TimelineInteractionMode } from './enums/timelineInteractionMode';\nimport { TimelineElementType } from './enums/timelineElementType';\nimport { TimelineCursorType } from './enums/timelineCursorType';\nimport { TimelineCapShape } from './enums/timelineCapShape';\nimport { TimelineEventSource } from './enums/timelineEventSource';\nimport { TimelineSelectionMode } from './enums/timelineSelectionMode';\nimport { TimelineEvents } from './enums/timelineEvents';\n// @private defaults are exposed:\nimport { defaultTimelineOptions, defaultTimelineConsts } from './settings/defaults';\n\nexport class Timeline extends TimelineEventsEmitter {\n  /**\n   * component container.\n   */\n  _container: HTMLElement | null = null;\n  /**\n   * Dynamically generated canvas inside of the container.\n   */\n  _canvas: HTMLCanvasElement | null = null;\n  /**\n   * Dynamically generated scroll container.\n   */\n  _scrollContainer: HTMLElement | null = null;\n  /**\n   * Dynamically generated virtual scroll content.\n   */\n  _scrollContent: HTMLElement | null = null;\n  /**\n   * Rendering context\n   */\n  _ctx: CanvasRenderingContext2D | null = null;\n  /**\n   * Components settings\n   */\n  _options: TimelineOptions | null = null;\n  /**\n   * Drag start position.\n   */\n  _startPos: TimelineMouseData | null = null;\n  /**\n   * Drag scroll started position.\n   */\n  _scrollStartPos: DOMPoint | null = { x: 0, y: 0 } as DOMPoint;\n  _currentPos: TimelineMouseData | null = null;\n\n  _selectionRect: DOMRect | null = null;\n  _selectionRectEnabled = false;\n  _drag: TimelineDraggableData | null = null;\n  _startedDragWithCtrl = false;\n  _startedDragWithShiftKey = false;\n\n  _clickTimeout? = 0;\n  _lastClickTime = 0;\n  _lastClickPoint: DOMPoint | null = null;\n  _consts: TimelineConsts = defaultTimelineConsts;\n  _clickAllowed = false;\n  /**\n   * scroll finished timer reference.\n   */\n  _scrollFinishedTimerRef?: number | null = null;\n  _val = 0;\n  _pixelRatio = 1;\n  _currentZoom = 0;\n  _intervalRef?: number | null = null;\n  _autoPanLastActionDate = 0;\n  _isPanStarted = false;\n  _interactionMode = TimelineInteractionMode.Selection;\n  _lastUsedArgs: MouseEvent | TouchEvent | null = null;\n  _model: TimelineModel | null = null;\n  /**\n   * Create Timeline instance\n   * @param options Timeline settings.\n   * @param model Timeline model.\n   */\n  constructor(options: TimelineOptions | null = null, model: TimelineModel | null = null) {\n    super();\n    // Allow to create instance without an error to perform tests.\n    if (options || model) {\n      this.initialize(options, model);\n    }\n  }\n\n  /**\n   * Initialize Timeline\n   * @param options Timeline settings.\n   * @param model Timeline model.\n   */\n  public initialize(options: TimelineOptions | null, model: TimelineModel | null): void {\n    this._model = model;\n    if (!options || !options.id) {\n      throw new Error(`Element cannot be empty. Should be string or DOM element.`);\n    }\n\n    this._generateContainers(options.id);\n    this._options = this._setOptions(options);\n    this._subscribeOnEvents();\n    this.rescale();\n    this.redraw();\n  }\n\n  /**\n   * Generate component html.\n   * @param id container.\n   */\n  _generateContainers(id: string | HTMLElement): void {\n    if (id instanceof HTMLElement) {\n      this._container = id as HTMLElement;\n    } else {\n      this._container = document.getElementById(id);\n    }\n\n    if (!this._container) {\n      throw new Error(`Element cannot be empty. Should be string or DOM element.`);\n    }\n\n    this._scrollContainer = document.createElement('div');\n    this._scrollContent = document.createElement('div');\n    this._canvas = document.createElement('canvas');\n\n    if (!this._canvas || !this._canvas.getContext) {\n      console.log('Cannot initialize canvas context.');\n      return null;\n    }\n\n    this._container.style.position = 'relative';\n    // Generate size container:\n    this._canvas.style.cssText =\n      'image-rendering: -moz-crisp-edges;' +\n      'image-rendering: -webkit-crisp-edges;' +\n      'image-rendering: pixelated;' +\n      'image-rendering: crisp-edges;' +\n      'user-select: none;' +\n      '-webkit-user-select: none;' +\n      '-khtml-user-select: none;' +\n      '-moz-user-select: none;' +\n      '-o-user-select: none;' +\n      'user-select: none;' +\n      'touch-action: none;' +\n      'position: relative;' +\n      '-webkit-user-drag: none;' +\n      '-khtml-user-drag: none;' +\n      '-moz-user-drag: none;' +\n      '-o-user-drag: none;' +\n      'user-drag: none;' +\n      'padding: inherit';\n\n    this._scrollContainer.style.cssText = 'overflow: scroll;' + 'position: absolute;' + 'width:  100%;' + 'height:  100%;';\n\n    this._scrollContent.style.width = this._scrollContent.style.height = '100%';\n\n    // add the text node to the created div\n    this._scrollContainer.appendChild(this._scrollContent);\n    this._container.appendChild(this._scrollContainer);\n    const scrollBarWidth = this._scrollContainer.offsetWidth - this._scrollContent.clientWidth;\n    // Calculate current browser scrollbar size and add offset for the canvas\n    this._canvas.style.width = this._canvas.style.height = 'calc(100% -' + (scrollBarWidth || 17) + 'px)';\n\n    this._container.appendChild(this._canvas);\n    this._ctx = this._canvas.getContext('2d');\n  }\n  /**\n   * Subscribe current component on the related events.\n   */\n  _subscribeOnEvents(): void {\n    this._container.addEventListener('wheel', this._handleWheelEvent);\n\n    if (this._scrollContainer) {\n      this._scrollContainer.addEventListener('scroll', this._handleScrollEvent);\n    }\n    document.addEventListener('keyup', this._handleKeyUp, false);\n    document.addEventListener('keydown', this._handleKeyDown, false);\n    window.addEventListener('blur', this._handleBlurEvent, false);\n    window.addEventListener('resize', this._handleWindowResizeEvent, false);\n\n    this._canvas.addEventListener('touchstart', this._handleMouseDownEvent, false);\n    this._canvas.addEventListener('mousedown', this._handleMouseDownEvent, false);\n    window.addEventListener('mousemove', this._handleMouseMoveEvent, false);\n    window.addEventListener('touchmove', this._handleMouseMoveEvent, false);\n    window.addEventListener('mouseup', this._handleMouseUpEvent, false);\n    window.addEventListener('touchend', this._handleMouseUpEvent, false);\n  }\n\n  public dispose(): void {\n    // Unsubscribe all events\n    this.offAll();\n    this._container = null;\n    this._canvas = null;\n    this._scrollContainer = null;\n    this._scrollContent = null;\n    this._ctx = null;\n    this._cleanUpSelection();\n\n    this._container.removeEventListener('wheel', this._handleWheelEvent);\n\n    if (this._scrollContainer) {\n      this._scrollContainer.removeEventListener('scroll', this._handleScrollEvent);\n    }\n\n    window.removeEventListener('blur', this._handleBlurEvent);\n    window.removeEventListener('resize', this._handleWindowResizeEvent);\n    document.removeEventListener('keydown', this._handleKeyDown);\n    document.removeEventListener('keyup', this._handleKeyUp);\n    this._canvas.removeEventListener('touchstart', this._handleMouseDownEvent);\n    this._canvas.removeEventListener('mousedown', this._handleMouseDownEvent);\n    window.removeEventListener('mousemove', this._handleMouseMoveEvent);\n    window.removeEventListener('touchmove', this._handleMouseMoveEvent);\n    window.removeEventListener('mouseup', this._handleMouseUpEvent);\n    window.removeEventListener('touchend', this._handleMouseUpEvent);\n    // Stop times\n    this._stopAutoPan();\n    this._clearScrollFinishedTimer();\n  }\n  _handleKeyUp = (event: KeyboardEvent): void => {\n    if (this._interactionMode === TimelineInteractionMode.Zoom) {\n      this._setZoomCursor(event);\n    }\n  };\n  _handleKeyDown = (event: KeyboardEvent): void => {\n    if (this._interactionMode === TimelineInteractionMode.Zoom) {\n      this._setZoomCursor(event);\n    }\n  };\n  _setZoomCursor(e: MouseEvent | KeyboardEvent): void {\n    if (this._controlKeyPressed(e)) {\n      this._setCursor(TimelineCursorType.ZoomOut);\n    } else {\n      this._setCursor(TimelineCursorType.ZoomIn);\n    }\n  }\n  _handleBlurEvent = (): void => {\n    this._cleanUpSelection();\n  };\n  _handleWindowResizeEvent = (): void => {\n    // Rescale and redraw\n    this.rescale();\n    this.redraw();\n  };\n\n  _clearScrollFinishedTimer(): void {\n    if (this._scrollFinishedTimerRef) {\n      clearTimeout(this._scrollFinishedTimerRef);\n      this._scrollFinishedTimerRef = null;\n    }\n  }\n  _handleScrollEvent = (args: MouseEvent): void => {\n    this._clearScrollFinishedTimer();\n    // Set a timeout to run event 'scrolling end'.\n    this._scrollFinishedTimerRef = window.setTimeout(() => {\n      if (!this._isPanStarted) {\n        if (this._scrollFinishedTimerRef) {\n          clearTimeout(this._scrollFinishedTimerRef);\n          this._scrollFinishedTimerRef = null;\n        }\n\n        this.rescale();\n        this.redraw();\n      }\n    }, this._consts.scrollFinishedTimeoutMs);\n\n    this.redraw();\n    this._emitScrollEvent(args);\n  };\n  _controlKeyPressed(e: MouseEvent | KeyboardEvent | TouchEvent): boolean {\n    if (!this._options || this._options.controlKeyIsMetaKey === undefined) {\n      return e.metaKey || e.ctrlKey;\n    }\n    return this._options.controlKeyIsMetaKey || this._options.controlKeyIsMetaKey ? e.metaKey : e.ctrlKey;\n  }\n  _handleWheelEvent = (event: WheelEvent): void => {\n    if (this._controlKeyPressed(event)) {\n      event.preventDefault();\n      const mousePos = Math.max(0, this._getMousePos(this._canvas, event).x || 0);\n      this._zoom(TimelineUtils.sign(event.deltaY), this._options.zoomSpeed, mousePos);\n    } else {\n      this._scrollContainer.scrollTop += event.deltaY;\n      event.preventDefault();\n    }\n  };\n  _zoom(direction: number, speed: number, x: number): void {\n    if (speed > 0 && speed <= 1) {\n      const deltaSpeed = TimelineUtils.getDistance(this._width() / 2, x) * 0.2;\n      x = x + deltaSpeed;\n      const diff = this._width() / x;\n      const val = this._fromScreen(x);\n      const zoom = direction * this._currentZoom * speed;\n      //this._options.zoom\n      this._currentZoom = this._setZoom(this._currentZoom + zoom);\n      // Get only after zoom is set\n      const zoomCenter = this.valToPx(val);\n      let newScrollLeft = Math.round(zoomCenter - this._width() / diff);\n      if (newScrollLeft <= 0) {\n        newScrollLeft = 0;\n      }\n\n      this._rescaleInternal(newScrollLeft + this._width(), null, 'zoom');\n      if (this._scrollContainer.scrollLeft != newScrollLeft) {\n        // Scroll event will redraw the screen.\n        this._scrollContainer.scrollLeft = newScrollLeft;\n      }\n\n      this.redraw();\n    }\n  }\n  /**\n   * Zoom in\n   * @param speed value from 0 to 1\n   */\n  public zoomIn(speed = this._options.zoomSpeed): void {\n    this._zoom(1, speed, this._scrollContainer.clientWidth / 2);\n  }\n  /**\n   * Zoom out.\n   * @param speed value from 0 to 1\n   */\n  public zoomOut(speed = this._options.zoomSpeed): void {\n    this._zoom(-1, speed, this._scrollContainer.clientWidth / 2);\n  }\n  /**\n   * Set direct zoom value.\n   * @param zoom zoom value to set. percent 0-1 and etc.\n   * @param min min zoom.\n   * @param max max zoom.\n   * @return normalized value.\n   */\n  _setZoom(zoom: number, min: number | undefined = null, max: number | undefined = null): number {\n    min = TimelineUtils.isNumber(min) ? min : this._options ? this._options.zoomMin : null;\n    max = TimelineUtils.isNumber(max) ? max : this._options ? this._options.zoomMax : null;\n    if (TimelineUtils.isNumber(zoom)) {\n      zoom = TimelineUtils.keepInBounds(zoom, min, max);\n      zoom = zoom || 1;\n      this._currentZoom = zoom;\n      return zoom;\n    }\n\n    return zoom;\n  }\n\n  /**\n   * Set direct zoom value.\n   * @public\n   * @param zoom zoom value to set. percent 0-1 and etc.\n   * @return normalized value.\n   */\n  setZoom(zoom: number): number {\n    const prevZoom = this.getZoom();\n    if (prevZoom !== zoom) {\n      const zoomSet = this._setZoom(zoom);\n      if (prevZoom != zoomSet) {\n        this.rescale();\n        this.redraw();\n        return zoomSet;\n      }\n    }\n    return prevZoom;\n  }\n  /**\n   * Get current zoom level.\n   */\n  getZoom(): number {\n    if (TimelineUtils.isNumber(this._currentZoom)) {\n      return this._currentZoom || 1;\n    }\n    return 1;\n  }\n  /**\n   * @param args\n   */\n  _handleMouseDownEvent = (args: MouseEvent): void => {\n    let isDoubleClick = Date.now() - this._lastClickTime < this._consts.doubleClickTimeoutMs;\n    // Prevent drag of the canvas if canvas is selected as text:\n    TimelineUtils.clearBrowserSelection();\n\n    this._startPos = this._trackMousePos(this._canvas, args);\n\n    if (!this._startPos) {\n      return;\n    }\n\n    // Don't allow to perform double click if mouse was moved to far.\n    if (this._lastClickPoint && this._startPos && TimelineUtils.getDistance(this._lastClickPoint.x, this._lastClickPoint.y, this._startPos.x, this._startPos.y) > this._consts.clickThreshold) {\n      isDoubleClick = false;\n    }\n\n    this._lastClickPoint = this._startPos;\n    this._scrollStartPos = {\n      x: this._scrollContainer.scrollLeft,\n      y: this._scrollContainer.scrollTop,\n    } as DOMPoint;\n    this._clickAllowed = true;\n    const elements = this.elementFromPoint(this._startPos, Math.max(2, this._startPos.radius));\n    const target = this._findDraggable(elements, this._startPos.val);\n    const event = new TimelineClickEvent();\n    event.pos = this._startPos;\n    event.val = this._startPos.val;\n    event.originalVal = this._startPos.originalVal;\n    event.snapVal = this._startPos.snapVal;\n    event.args = args;\n    // all elements under the click:\n    event.elements = elements;\n    // target element.\n    event.target = target;\n\n    if (isDoubleClick) {\n      super.emit(TimelineEvents.DoubleClick, event);\n      return;\n    }\n\n    super.emit(TimelineEvents.MouseDown, event);\n\n    this._clickTimeout = Date.now();\n    this._lastClickTime = Date.now();\n    if (event.isPrevented()) {\n      // Mouse up will be also prevented\n      this._cleanUpSelection();\n      return;\n    }\n\n    this._currentPos = this._startPos;\n\n    // Select keyframes on mouse down\n    if (target && this._interactionMode !== TimelineInteractionMode.Zoom) {\n      this._drag = {\n        changed: false,\n        target: this._setElementDragState(target, target.val),\n        val: target.val,\n        type: target.type,\n        elements: [],\n      } as TimelineDraggableData;\n\n      if (target.type === TimelineElementType.Keyframe) {\n        this._startedDragWithCtrl = this._controlKeyPressed(args);\n        this._startedDragWithShiftKey = args.shiftKey;\n        // get all related selected keyframes if we are selecting one.\n        if (!target.keyframe.selected && !this._controlKeyPressed(args)) {\n          this._selectInternal(target.keyframe);\n        }\n        // Allow to drag all selected keyframes on a screen\n        this._drag.elements = this.getSelectedElements().map((element) => {\n          return this._setElementDragState(element, element.val);\n        });\n      } else if (target.type === TimelineElementType.Group) {\n        const keyframes = this._drag.target.keyframes;\n\n        if (keyframes && Array.isArray(keyframes)) {\n          this._drag.elements = keyframes.map((keyframe) => {\n            return this._setElementDragState(this._convertToElement(this._drag.target.row, keyframe), keyframe.val);\n          });\n        }\n      } else {\n        this._drag.elements = [this._drag.target];\n      }\n    }\n\n    this.redraw();\n  };\n  _setElementDragState(element: TimelineElement | TimelineElementDragState, val: number): TimelineElementDragState {\n    const state = element as TimelineElementDragState;\n    state.prevVal = state.val;\n    if (state.startedVal === undefined || state.startedVal === null) {\n      state.startedVal = val;\n    }\n    if (state.prevVal === undefined || state.prevVal === null) {\n      state.prevVal = val;\n    }\n    state.val = val;\n    return state;\n  }\n  isLeftButtonClicked(args: MouseEvent | TouchEvent | any): boolean {\n    return !!args && args.buttons == 1;\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  _handleMouseMoveEvent = (args: MouseEvent | TouchEvent | any): void => {\n    if (!args) {\n      args = this._lastUsedArgs;\n    } else {\n      this._lastUsedArgs = args;\n    }\n    if (!args) {\n      return;\n    }\n    const isTouch = args.changedTouches && args.changedTouches.length > 0;\n    this._currentPos = this._trackMousePos(this._canvas, args);\n    if (!this._isPanStarted && this._selectionRect && this._clickTimeoutIsOver()) {\n      // TODO: implement selection by rect\n      this._selectionRectEnabled = this._interactionMode !== TimelineInteractionMode.Zoom;\n    } else {\n      this._selectionRectEnabled = false;\n    }\n\n    args = args as MouseEvent;\n    const isLeftClicked = this.isLeftButtonClicked(args);\n    if (this._startPos) {\n      if (isLeftClicked || isTouch) {\n        if (this._drag && !this._startedDragWithCtrl) {\n          const convertedVal = this._currentPos.val;\n          if (this._drag.type === TimelineElementType.Timeline) {\n            this._setTimeInternal(convertedVal, TimelineEventSource.User);\n          } else if ((this._drag.type == TimelineElementType.Keyframe || this._drag.type == TimelineElementType.Group) && this._drag.elements) {\n            const offset = Math.floor(convertedVal - this._drag.val);\n            const movedOffset = this._moveElements(offset, this._drag.elements, TimelineEventSource.User);\n            if (movedOffset !== 0) {\n              if (!this._drag.changed) {\n                this._drag.prevVal = this._drag.val;\n                const eventArgs = this._emitDragStartedEvent();\n                if (eventArgs.isPrevented()) {\n                  // Cleanup drag here, so drag finished will be ignored.\n                  this._drag = null;\n                  this._cleanUpSelection();\n                  return;\n                }\n              }\n\n              this._drag.changed = true;\n              this._drag.val += offset;\n              this._emitDragEvent();\n            }\n          }\n        }\n\n        if (this._interactionMode === TimelineInteractionMode.Pan && !this._drag) {\n          this._isPanStarted = true;\n          this._setCursor(TimelineCursorType.Grabbing);\n          // Track scroll by drag.\n          this._scrollByPan(this._startPos, this._currentPos, this._scrollStartPos);\n        } else {\n          // Track scroll by mouse or touch out of the area.\n          this._scrollBySelectionOutOfBounds(this._currentPos);\n        }\n\n        this.redraw();\n      } else {\n        // Fallback. Cancel mouse move when focus was lost and mouse down is still counted.\n        this._cleanUpSelection();\n        this.redraw();\n      }\n    } else if (!isTouch) {\n      const elements = this.elementFromPoint(this._currentPos, Math.max(2, this._currentPos.radius));\n      const target = this._findDraggable(elements, this._currentPos.val);\n      if (this._isPanStarted || this._interactionMode === TimelineInteractionMode.Pan) {\n        if (isLeftClicked) {\n          this._setCursor(TimelineCursorType.Grabbing);\n        } else {\n          this._setCursor(TimelineCursorType.Grab);\n        }\n      } else {\n        if (this._interactionMode === TimelineInteractionMode.Zoom) {\n          this._setZoomCursor(args);\n          return;\n        } else {\n          this._setCursor(TimelineCursorType.Default);\n        }\n      }\n\n      if (target) {\n        let cursor: TimelineCursorType | null = null;\n        if (target.type === TimelineElementType.Group) {\n          cursor = cursor || TimelineCursorType.EWResize;\n        } else if (target.type == TimelineElementType.Keyframe) {\n          cursor = cursor || TimelineCursorType.Pointer;\n        } else if (target.type == TimelineElementType.Timeline) {\n          cursor = cursor || TimelineCursorType.EWResize;\n        }\n\n        if (cursor) {\n          this._setCursor(cursor);\n        }\n      }\n    }\n\n    if (isTouch) {\n      args.preventDefault();\n    }\n  };\n\n  /**\n   * Move elements\n   * @param offset vector to move elements along.\n   * @param elements Element to move.\n   * @returns real moved value.\n   */\n  _moveElements(offset: number, elements: Array<TimelineElementDragState>, source: TimelineEventSource = TimelineEventSource.Programmatically): number {\n    if (!elements) {\n      return;\n    }\n    let isChanged = false;\n    if (Math.abs(offset) > 0) {\n      // Find drag min and max bounds:\n      let bounds = { min: Number.MIN_SAFE_INTEGER, max: Number.MAX_SAFE_INTEGER } as TimelineRanged;\n      bounds = TimelineUtils.setMinMax(bounds, this._options);\n      elements.forEach((p) => {\n        // find allowed bounds for the draggable items.\n        // find for each row and keyframe separately.\n        const currentBounds = TimelineUtils.setMinMax(TimelineUtils.setMinMax({ min: bounds.min, max: bounds.max }, p.keyframe), p.row);\n        const expectedKeyframeValue = this._options && this._options.snapAllKeyframesOnMove ? this.snapVal(p.keyframe.val) : p.keyframe.val;\n        const newPosition = expectedKeyframeValue + offset;\n        if (TimelineUtils.isNumber(currentBounds.min) && newPosition < currentBounds.min) {\n          // Return to the bounds:\n          offset = offset + TimelineUtils.getDistance(currentBounds.min, newPosition);\n        }\n        if (TimelineUtils.isNumber(currentBounds.max) && newPosition > currentBounds.max) {\n          // Return to the bounds:\n          offset = offset - TimelineUtils.getDistance(currentBounds.max, newPosition);\n        }\n      });\n\n      if (Math.abs(offset) > 0) {\n        // don't allow to move less than zero.\n        elements.forEach((element) => {\n          const prevVal = element.keyframe.val;\n          const toSet = prevVal + offset;\n          const newValue = this._setKeyframePos(element, toSet, source);\n          isChanged = newValue !== prevVal;\n        });\n      }\n\n      if (isChanged) {\n        return offset;\n      }\n    }\n\n    return 0;\n  }\n  _handleMouseUpEvent = (args: MouseEvent): void => {\n    if (this._startPos) {\n      //window.releaseCapture();\n      const pos = this._trackMousePos(this._canvas, args);\n\n      // Click detection.\n      if (this._clickAllowed || !this._clickTimeoutIsOver() || (this._drag && (this._startedDragWithCtrl || this._startedDragWithShiftKey))) {\n        if (this._options && this._interactionMode === TimelineInteractionMode.Zoom) {\n          const direction = this._controlKeyPressed(args) ? 1 : -1;\n          const mousePos = Math.max(0, this._getMousePos(this._canvas, args).x || 0);\n          this._zoom(direction, this._options.zoomSpeed, mousePos);\n        } else {\n          this._performClick(pos, this._drag);\n        }\n      } else if (!this._drag && this._selectionRect && this._selectionRectEnabled) {\n        if (this._interactionMode === TimelineInteractionMode.Zoom) {\n          if (this._selectionRect.width > 20) {\n            // TODO: implement zoom by screen rect.\n          }\n        } else {\n          const keyframes = this._getKeyframesByRectangle(this._selectionRect);\n          const selectionMode = args.shiftKey ? TimelineSelectionMode.Append : TimelineSelectionMode.Normal;\n          this.select(keyframes, selectionMode);\n        }\n      }\n\n      this._cleanUpSelection();\n      this.redraw();\n    }\n  };\n\n  /**\n   * client height.\n   */\n  _height(): number {\n    if (this._canvas) {\n      return this._canvas.clientHeight;\n    }\n    return 0;\n  }\n\n  /**\n   * Client width;\n   */\n  _width(): number {\n    if (this._canvas) {\n      return this._canvas.clientWidth;\n    }\n    return 0;\n  }\n  /**\n   * Convert virtual calculation results to keyframes\n   */\n  _mapKeyframes(array: Array<TimelineCalculatedKeyframe | TimelineElement>): Array<TimelineKeyframe> {\n    const results: Array<TimelineKeyframe> = [];\n    if (!array) {\n      return results;\n    }\n\n    for (let i = 0; i < array.length; i++) {\n      results.push((array[i] as TimelineCalculatedKeyframe).model || (array[i] as TimelineElement).keyframe);\n    }\n    return results;\n  }\n  /**\n   * Get all keyframes under the screen rectangle.\n   * @param screenRect screen coordinates to get keyframes.\n   */\n  _getKeyframesByRectangle(screenRect: DOMRect): TimelineKeyframe[] {\n    const keyframesModels: Array<TimelineKeyframe> = [];\n    this._forEachKeyframe((calcKeyframe) => {\n      if (TimelineUtils.isOverlap(calcKeyframe.size.x, calcKeyframe.size.y, screenRect)) {\n        keyframesModels.push(calcKeyframe.model);\n      }\n    });\n    return keyframesModels;\n  }\n\n  _performClick(pos: TimelineMouseData, drag: TimelineDraggableData): boolean {\n    let isChanged = false;\n    if (drag && drag.type === TimelineElementType.Keyframe) {\n      let mode = TimelineSelectionMode.Normal;\n      if ((this._startedDragWithCtrl && this._controlKeyPressed(pos.args)) || (this._startedDragWithShiftKey && pos.args.shiftKey)) {\n        if (this._controlKeyPressed(pos.args)) {\n          mode = TimelineSelectionMode.Revert;\n        }\n      }\n      // Reverse selected keyframe selection by a click:\n      isChanged = this._selectInternal(this._drag.target.keyframe, mode).selectionChanged || isChanged;\n\n      if (pos.args.shiftKey) {\n        // Set current timeline position if it's not a drag or selection rect small or fast click.\n        isChanged = this._setTimeInternal(pos.val, TimelineEventSource.User) || isChanged;\n      }\n    } else {\n      // deselect keyframes if any:\n      isChanged = this._selectInternal(null).selectionChanged || isChanged;\n\n      // change timeline pos:\n      // Set current timeline position if it's not a drag or selection rect small or fast click.\n      isChanged = this._setTimeInternal(pos.val, TimelineEventSource.User) || isChanged;\n    }\n\n    return isChanged;\n  }\n  /**\n   * Set keyframe value.\n   * @param keyframe\n   * @param value\n   * @return set value.\n   */\n  _setKeyframePos(element: TimelineElementDragState, value: number, source: TimelineEventSource = TimelineEventSource.Programmatically): number {\n    if (!element || !element.keyframe) {\n      return value;\n    }\n    value = Math.floor(value);\n    if (element.keyframe && element.keyframe.val != value) {\n      element.prevVal = element.val;\n      element.val = value;\n      element.keyframe.val = value;\n      const event = this._emitKeyframeChanged(element, source);\n      if (event.isPrevented()) {\n        element.val = event.prevVal;\n        element.keyframe.val = event.prevVal;\n      }\n\n      return value;\n    }\n\n    return value;\n  }\n\n  /**\n   * @param cursor to set.\n   */\n  _setCursor(cursor: string): void {\n    if (this._canvas.style.cursor != cursor) {\n      this._canvas.style.cursor = cursor;\n    }\n  }\n\n  /**\n   * Set pan mode\n   * @param isPan\n   */\n  public setInteractionMode(mode: TimelineInteractionMode): void {\n    if (this._interactionMode != mode) {\n      this._interactionMode = mode;\n      // Avoid any conflicts with other modes:\n      this._cleanUpSelection();\n    }\n  }\n  /**\n   * Get current interaction mode.\n   */\n  public getInteractionMode(): TimelineInteractionMode {\n    return this._interactionMode;\n  }\n  _convertToElement(row: TimelineRow, keyframe: TimelineKeyframe): TimelineElement {\n    const data = {\n      type: TimelineElementType.Keyframe,\n      val: keyframe.val,\n      keyframe: keyframe,\n      row: row,\n    } as TimelineElement;\n    return data;\n  }\n\n  public getSelectedKeyframes(): Array<TimelineKeyframe> {\n    return this._mapKeyframes(this.getSelectedElements());\n  }\n\n  public getSelectedElements(): Array<TimelineElement> {\n    const selected: Array<TimelineElement> = [];\n    this._forEachKeyframe((keyframe): void => {\n      if (keyframe && keyframe.model.selected) {\n        selected.push(this._convertToElement(keyframe.parentRow.model, keyframe.model));\n      }\n      return;\n    });\n\n    return selected;\n  }\n  public getAllKeyframes(): Array<TimelineKeyframe> {\n    const selected: Array<TimelineKeyframe> = [];\n    this._forEachKeyframe((keyframe): void => {\n      selected.push(keyframe.model);\n    });\n\n    return selected;\n  }\n\n  public selectAllKeyframes(): TimelineSelectionResults {\n    return this.select(this.getAllKeyframes(), TimelineSelectionMode.Normal);\n  }\n  public deselectAll(): TimelineSelectionResults {\n    return this.select(null);\n  }\n\n  private _changeNodeState(state: TimelineSelectionResults, node: TimelineKeyframe, value: boolean): boolean {\n    if (node.selected !== value) {\n      const selectable = typeof node.selectable === 'boolean' ? node.selectable : true;\n      if (!value || (value && selectable)) {\n        node.selected = value;\n        state.changed.push(node);\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  public select(nodes: TimelineKeyframe[] | TimelineKeyframe | null, mode = TimelineSelectionMode.Normal): TimelineSelectionResults {\n    const results = this._selectInternal(nodes, mode);\n    if (results.selectionChanged) {\n      this.redraw();\n    }\n    return results;\n  }\n\n  /**\n   * Select keyframes\n   * @param nodes keyframe or list of the keyframes to be selected.\n   * @param mode selection mode.\n   */\n  public _selectInternal(nodes: TimelineKeyframe[] | TimelineKeyframe | null, mode = TimelineSelectionMode.Normal): TimelineSelectionResults {\n    if (!nodes) {\n      nodes = [];\n    }\n    if (!Array.isArray(nodes)) {\n      nodes = [nodes];\n    }\n\n    const state = {\n      selectionChanged: false,\n      selected: this.getSelectedKeyframes(),\n      changed: [] as Array<any>,\n    } as TimelineSelectionResults;\n    const nodesArray = nodes as TimelineKeyframe[];\n    //const state = this.selectedSubject.getValue();\n    this.getSelectedElements();\n    if (nodesArray && mode === TimelineSelectionMode.Append) {\n      nodes.forEach((node) => {\n        const changed = this._changeNodeState(state, node, true);\n        if (changed && node.selected) {\n          state.selected.push(node);\n        }\n      });\n    } else if (nodesArray && mode === TimelineSelectionMode.Revert) {\n      nodes.forEach((node) => {\n        if (state.selected.indexOf(node) >= 0) {\n          this._changeNodeState(state, node, false);\n          TimelineUtils.deleteElement<TimelineKeyframe>(state.selected, node);\n        } else {\n          this._changeNodeState(state, node, true);\n          if (node.selected) {\n            state.selected.push(node);\n          }\n        }\n      });\n    } else if (mode === TimelineSelectionMode.Normal) {\n      const selectedItems: Array<TimelineKeyframe> = [];\n      if (nodes) {\n        nodes.forEach((node) => {\n          this._changeNodeState(state, node, true);\n          if (node.selected) {\n            selectedItems.push(node);\n          }\n        });\n      }\n\n      state.selected.forEach((node) => {\n        const exists = nodesArray.indexOf(node) >= 0;\n        // Deselect\n        if (!exists) {\n          this._changeNodeState(state, node, false);\n        }\n      });\n\n      if (state.changed.length > 0) {\n        if (selectedItems) {\n          state.selected = selectedItems;\n        } else {\n          state.selected.length = 0;\n        }\n      }\n    }\n\n    if (state.changed.length > 0) {\n      state.selectionChanged = true;\n      this._emitKeyframesSelected(state);\n    }\n\n    return state;\n  }\n\n  /**\n   * foreach visible keyframe.\n   */\n  _forEachKeyframe(callback: (keyframe: TimelineCalculatedKeyframe, index?: number, newRow?: boolean) => void): void {\n    if (!callback) {\n      return;\n    }\n    if (!this._model) {\n      return;\n    }\n\n    const calculatedModel = this._calculateModel();\n    if (!calculatedModel) {\n      return;\n    }\n\n    calculatedModel.rows.forEach((calcRow) => {\n      if (!calcRow) {\n        return;\n      }\n\n      let nextRow = true;\n      calcRow.keyframes.forEach((keyframe, keyframeIndex) => {\n        if (keyframe) {\n          callback(keyframe, keyframeIndex, nextRow);\n        }\n\n        nextRow = false;\n      });\n    });\n  }\n\n  _trackMousePos(canvas: HTMLCanvasElement, mouseArgs: MouseEvent | TouchEvent): TimelineMouseData {\n    const pos = this._getMousePos(canvas, mouseArgs) as TimelineMouseData;\n    pos.originalVal = this._mousePosToVal(pos.x, false);\n    pos.snapVal = this._mousePosToVal(pos.x, true);\n    pos.val = pos.originalVal;\n    if (this._options && this._options.snapEnabled) {\n      pos.val = pos.snapVal;\n    }\n\n    if (this._startPos) {\n      if (!this._selectionRect) {\n        this._selectionRect = {} as DOMRect;\n      }\n\n      // get the pos with the virtualization:\n      const x = Math.floor(this._startPos.x + (this._scrollStartPos.x - this.getScrollLeft()));\n      const y = Math.floor(this._startPos.y + (this._scrollStartPos.y - this.getScrollTop()));\n      this._selectionRect.x = Math.min(x, pos.x);\n      this._selectionRect.y = Math.min(y, pos.y);\n      this._selectionRect.width = Math.max(x, pos.x) - this._selectionRect.x;\n      this._selectionRect.height = Math.max(y, pos.y) - this._selectionRect.y;\n      // Once mouse was moved outside of the bounds it's not a click anymore\n      if (this._clickAllowed) {\n        this._clickAllowed = this._selectionRect.height <= this._consts.clickThreshold && this._selectionRect.width <= this._consts.clickThreshold;\n      }\n    }\n\n    return pos;\n  }\n\n  _cleanUpSelection(): void {\n    this._emitDragFinishedEvent();\n    this._startPos = null;\n    this._drag = null;\n    this._startedDragWithCtrl = false;\n    this._startedDragWithShiftKey = false;\n    this._selectionRect = null;\n    this._clickTimeout = null;\n    this._scrollStartPos = null;\n    this._isPanStarted = false;\n    this._clickAllowed = false;\n    this._stopAutoPan();\n  }\n\n  /**\n   * Check whether click timeout is over.\n   */\n  _clickTimeoutIsOver(): boolean {\n    // Duration before the selection can be tracked.\n    if (this._clickTimeout && Date.now() - this._clickTimeout > this._consts.clickDetectionMs) {\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Automatically pan. Scroll canvas when selection is made and mouse outside of the bounds.\n   */\n  _startAutoPan(): void {\n    if (this._consts.autoPanSpeed) {\n      if (!this._intervalRef) {\n        // Repeat move calls to\n        this._intervalRef = window.setInterval(() => {\n          this._handleMouseMoveEvent(null);\n        }, this._consts.autoPanSpeed);\n      }\n    }\n  }\n\n  /**\n   * Stop current running auto pan\n   */\n  _stopAutoPan(): void {\n    if (this._intervalRef) {\n      clearInterval(this._intervalRef);\n      this._intervalRef = null;\n    }\n\n    this._autoPanLastActionDate = null;\n  }\n\n  /**\n   * Check whether auto pan should be slowed down a bit.\n   */\n  _checkUpdateSpeedTooFast(): boolean {\n    // Slow down updated a bit.\n    if (this._autoPanLastActionDate && Date.now() - this._autoPanLastActionDate <= 10) {\n      return true;\n    }\n\n    this._autoPanLastActionDate = Date.now();\n    return false;\n  }\n\n  _scrollByPan(start: TimelineMouseData, pos: TimelineMouseData, scrollStartPos: DOMPoint): void {\n    if (!start || !pos) {\n      return;\n    }\n\n    const offsetX = Math.round(start.x - pos.x);\n    const newLeft = scrollStartPos.x + offsetX;\n\n    if (offsetX > 0) {\n      this._rescaleInternal(newLeft + this._width());\n    }\n\n    if (offsetX > 0 && newLeft + this._width() >= this._scrollContainer.scrollWidth - 5) {\n      this._scrollContainer.scrollLeft = this._scrollContainer.scrollWidth;\n    } else {\n      this._scrollContainer.scrollLeft = newLeft;\n    }\n    this._scrollContainer.scrollTop = Math.round(scrollStartPos.y + start.y - pos.y);\n  }\n\n  _scrollBySelectionOutOfBounds(pos: DOMPoint): boolean {\n    const x = pos.x;\n    const y = pos.y;\n    let isChanged = false;\n    let speedX = 0;\n    let speedY = 0;\n    // Small offset to start auto pan earlier.\n    const bounds = this._consts.autoPanByScrollPadding;\n    const isLeft = x <= bounds;\n    const isRight = x >= this._width() - bounds;\n    const isTop = y <= bounds;\n    const isBottom = y >= this._height() - bounds;\n    let newWidth = null;\n    let newHeight = null;\n    if (isLeft || isRight || isTop || isBottom) {\n      // Auto move init\n      this._startAutoPan();\n\n      if (this._checkUpdateSpeedTooFast()) {\n        return false;\n      }\n\n      const scrollSpeedMultiplier = isNaN(this._consts.scrollByDragSpeed) ? 1 : this._consts.scrollByDragSpeed;\n      if (isLeft) {\n        // Get normalized speed.\n        speedX = -TimelineUtils.getDistance(x, bounds) * scrollSpeedMultiplier;\n      } else if (isRight) {\n        // Get normalized speed:\n        speedX = TimelineUtils.getDistance(x, this._width() - bounds) * scrollSpeedMultiplier;\n        newWidth = this.getScrollLeft() + this._width() + speedX;\n      }\n\n      if (isTop) {\n        // Get normalized speed.\n        speedY = (-TimelineUtils.getDistance(x, bounds) * scrollSpeedMultiplier) / 4;\n      } else if (isBottom) {\n        // Get normalized speed:\n        speedY = (TimelineUtils.getDistance(x, this._height() - bounds) * scrollSpeedMultiplier) / 4;\n        newHeight = this._scrollContainer.scrollTop + this._height();\n      }\n    } else {\n      this._stopAutoPan();\n    }\n\n    if (newWidth || newHeight) {\n      this._rescaleInternal(newWidth, newHeight, 'scrollBySelection');\n    }\n\n    if (Math.abs(speedX) > 0) {\n      this._scrollContainer.scrollLeft += speedX;\n      isChanged = true;\n    }\n\n    if (Math.abs(speedY) > 0) {\n      this._scrollContainer.scrollTop += speedY;\n      isChanged = true;\n    }\n\n    return isChanged;\n  }\n\n  /**\n   * Convert screen pixel to value.\n   */\n  public pxToVal(px: number): number {\n    if (!this._options) {\n      return px;\n    }\n    let min = this._options.min;\n    if (!TimelineUtils.isNumber(min)) {\n      min = 0;\n    }\n    min *= this._currentZoom || 1;\n    const steps = (this._options.stepVal || 0) * this._currentZoom || 1;\n    const val = min + (px / this._options.stepPx) * steps;\n    return val;\n  }\n\n  /**\n   * Convert value to local screen component coordinates.\n   */\n  _toScreenPx(val: number): number {\n    return this.valToPx(val) - this.getScrollLeft() + this._leftMargin();\n  }\n  /**\n   * Convert screen local coordinates to a global value info.\n   */\n  _fromScreen(px: number): number {\n    return this.pxToVal(this.getScrollLeft() + px - this._leftMargin());\n  }\n  /**\n   * Convert area value to global screen pixel coordinates.\n   */\n  public valToPx(val: number): number {\n    if (!this._options) {\n      return val;\n    }\n    let min = this._options.min;\n    if (!TimelineUtils.isNumber(min)) {\n      min = 0;\n    }\n    min *= this._currentZoom || 1;\n    const steps = (this._options.stepVal || 0) * this._currentZoom || 1;\n    return (-min + val) * (this._options.stepPx / steps);\n  }\n\n  /**\n   * Snap a value to a nearest grid point.\n   */\n  public snapVal(val: number): number {\n    // Snap a value if configured.\n    if (this._options && this._options.snapEnabled && this._options.snapStep) {\n      const stops = this._options.snapStep;\n      const step = val / stops;\n      const stepsFit = Math.round(step);\n      const minSteps = Math.abs(this._options.min) / this._options.snapStep;\n      const minOffset = TimelineUtils.sign(this._options.min) * (minSteps - Math.floor(minSteps)) * this._options.snapStep;\n      val = Math.round(minOffset) + Math.round(stepsFit * stops);\n    }\n\n    val = TimelineUtils.keepInBounds(val, this._options.min, this._options.max);\n    return val;\n  }\n\n  _mousePosToVal(x: number, snapEnabled = false): number {\n    const mousePos = Math.min(x, this._width());\n    let convertedVal = this._fromScreen(mousePos);\n    convertedVal = Math.round(convertedVal);\n    if (snapEnabled) {\n      convertedVal = this.snapVal(convertedVal);\n    }\n\n    return convertedVal;\n  }\n\n  /**\n   * Format line gauge text.\n   * Default formatting is HMS\n   * @param ms milliseconds to convert.\n   * @param isSeconds whether seconds are passed.\n   */\n  _formatUnitsText(ms: number, isSeconds = false): string {\n    const sign = TimelineUtils.sign(ms) < 0 ? '-' : '';\n    ms = Math.abs(ms);\n    // 1- Convert to seconds:\n    let seconds = ms / 1000;\n    if (isSeconds) {\n      seconds = ms;\n    }\n\n    const year = Math.floor(seconds / (365 * 86400));\n    seconds = seconds % (365 * 86400);\n\n    const days = Math.floor(seconds / 86400);\n    seconds = seconds % 86400;\n\n    // 2- Extract hours:\n    const hours = Math.floor(seconds / 3600); // 3,600 seconds in 1 hour\n    seconds = seconds % 3600; // seconds remaining after extracting hours\n    // 3- Extract minutes:\n    const minutes = Math.floor(seconds / 60); // 60 seconds in 1 minute\n    // 4- Keep only seconds not extracted to minutes:\n    seconds = seconds % 60;\n    let str = '';\n    if (year) {\n      str += year + ':';\n    }\n\n    if (days) {\n      str += days + ':';\n    }\n\n    if (hours) {\n      str += hours + ':';\n    }\n\n    if (minutes) {\n      str += minutes + ':';\n    }\n\n    if (!isNaN(seconds)) {\n      str += seconds;\n    }\n\n    return sign + str;\n  }\n  /**\n   * Left padding of the timeline.\n   */\n  _leftMargin(): number {\n    if (!this._options) {\n      return 0;\n    }\n    return this._options.leftMargin || 0;\n  }\n  _renderTicks(): void {\n    const rulerActive = !!this._ctx && !!this._options && !!this._ctx.canvas && this._ctx.canvas.clientWidth > 0 && this._ctx.canvas.clientHeight > 0 && this._options.stepPx;\n    if (!rulerActive) {\n      return;\n    }\n    const screenWidth = this._width() - this._leftMargin();\n    let from = this.pxToVal(this.getScrollLeft());\n    let to = this.pxToVal(this.getScrollLeft() + screenWidth);\n    if (isNaN(from) || isNaN(to) || from === to) {\n      return;\n    }\n\n    if (to < from) {\n      const wasToVal = to;\n      to = from;\n      from = wasToVal;\n    }\n\n    const valDistance = TimelineUtils.getDistance(from, to);\n    if (valDistance <= 0) {\n      return;\n    }\n\n    // Find the nearest 'beautiful' step for a gauge.\n    // 'beautiful' step should be dividable by 1/2/5/10!\n    const step = TimelineUtils.findGoodStep(valDistance / (screenWidth / this._options.stepPx));\n    const smallStep = TimelineUtils.findGoodStep(valDistance / (screenWidth / this._options.stepSmallPx));\n\n    // Find beautiful start point:\n    const fromVal = Math.floor(from / step) * step;\n\n    // Find a beautiful end point:\n    const toVal = Math.ceil(to / step) * step + step;\n\n    if (!TimelineUtils.isNumber(step) || step <= 0 || Math.abs(toVal - fromVal) === 0) {\n      return;\n    }\n\n    let lastTextStart = 0;\n    this._ctx.save();\n    const headerHeight = TimelineStyleUtils.headerHeight(this._options);\n    const tickHeight = headerHeight / 2;\n    const smallTickHeight = headerHeight / 1.3;\n    for (let i = fromVal; i <= toVal; i += step) {\n      // local\n      const sharpPos = this._getSharp(this._toScreenPx(i));\n      this._ctx.save();\n      this._ctx.beginPath();\n      this._ctx.setLineDash([4]);\n      this._ctx.lineWidth = 1;\n      this._ctx.strokeStyle = this._options.tickColor;\n      TimelineUtils.drawLine(this._ctx, sharpPos, tickHeight, sharpPos, headerHeight);\n      this._ctx.stroke();\n\n      this._ctx.fillStyle = this._options.labelsColor;\n      if (this._options.font) {\n        this._ctx.font = this._options.font;\n      }\n\n      const text = this._formatUnitsText(i);\n      const textSize = this._ctx.measureText(text);\n\n      const textX = sharpPos - textSize.width / 2;\n      // skip text render if there is no space for it.\n      if (isNaN(lastTextStart) || lastTextStart <= textX) {\n        lastTextStart = textX + textSize.width;\n        this._ctx.fillText(text, textX, 10);\n      }\n\n      this._ctx.restore();\n      if (!TimelineUtils.isNumber(smallStep) || smallStep <= 0) {\n        continue;\n      }\n      // Draw small steps\n      for (let x = i + smallStep; x < i + step; x += smallStep) {\n        // local\n        const nextSharpPos = this._getSharp(this._toScreenPx(x));\n        this._ctx.beginPath();\n        this._ctx.lineWidth = this._pixelRatio;\n        this._ctx.strokeStyle = this._options.tickColor;\n        TimelineUtils.drawLine(this._ctx, nextSharpPos, smallTickHeight, nextSharpPos, headerHeight);\n        this._ctx.stroke();\n      }\n    }\n\n    this._ctx.restore();\n  }\n\n  /**\n   * calculate virtual mode. Determine screen positions for the elements.\n   */\n  _calculateModel(): TimelineModelCalcResults {\n    const toReturn = {\n      rows: [],\n      size: {\n        x: 0,\n        y: 0,\n        width: 0,\n        height: 0,\n      } as DOMRect,\n      min: null,\n      max: null,\n      keyframes: [] as Array<TimelineCalculatedKeyframe>,\n    } as TimelineModelCalcResults;\n\n    if (!this._model) {\n      return toReturn;\n    }\n    const rows = this._model.rows;\n    if (!rows || !Array.isArray(rows) || rows.length <= 0) {\n      return toReturn;\n    }\n    let rowAbsoluteHeight = TimelineStyleUtils.headerHeight(this._options);\n    rows.forEach((row, index) => {\n      if (!row || row.hidden) {\n        return;\n      }\n\n      // draw with scroll virtualization:\n      const rowHeight = TimelineStyleUtils.getRowHeight(row, this._options);\n      const marginBottom = TimelineStyleUtils.getRowMarginBottom(row, this._options);\n      const currentRowY = rowAbsoluteHeight - (this._scrollContainer ? this._scrollContainer.scrollTop : 0);\n      rowAbsoluteHeight += rowHeight + marginBottom;\n      if (index == 0) {\n        toReturn.size.y = currentRowY;\n      }\n\n      toReturn.size.height = Math.max(rowAbsoluteHeight + rowHeight, toReturn.size.height);\n\n      const calcRow = {\n        size: { x: 0, y: currentRowY, width: this._canvas ? this._width() : 0, height: rowHeight } as DOMRect,\n        marginBottom: marginBottom,\n        model: row,\n        min: null,\n        max: null,\n        groups: [] as Array<TimelineCalculatedGroup>,\n        keyframes: [] as Array<TimelineCalculatedKeyframe>,\n      } as TimelineCalculatedRow;\n      toReturn.rows.push(calcRow);\n      if (!row.keyframes || !row.keyframes.forEach || row.keyframes.length <= 0) {\n        return;\n      }\n\n      // Get min and max ms to draw keyframe rows:\n      if (row && row.keyframes) {\n        row.keyframes.forEach((keyframe) => {\n          if (keyframe && !isNaN(keyframe.val) && !keyframe.hidden) {\n            let currentGroup: TimelineCalculatedGroup = null;\n            for (let i = 0; i < calcRow.groups.length; i++) {\n              const existingGroup = calcRow.groups[i];\n              if (keyframe.group === existingGroup.group) {\n                currentGroup = existingGroup;\n                break;\n              }\n            }\n            if (!currentGroup) {\n              currentGroup = {\n                min: null,\n                max: null,\n                group: keyframe.group,\n                keyframes: [] as Array<TimelineCalculatedKeyframe>,\n              } as TimelineCalculatedGroup;\n\n              calcRow.groups.push(currentGroup);\n            }\n            const keyframeSize = this._getKeyframePosition(keyframe, calcRow);\n            const calcKeyframe = {\n              model: keyframe,\n              parentRow: calcRow,\n              parentGroup: currentGroup,\n              size: keyframeSize,\n            } as TimelineCalculatedKeyframe;\n\n            const min = currentGroup.min == null ? keyframe.val : Math.min(keyframe.val, currentGroup.min);\n            const max = currentGroup.max == null ? keyframe.val : Math.max(keyframe.val, currentGroup.max);\n            if (!isNaN(min)) {\n              currentGroup.min = min;\n            }\n            if (!isNaN(max)) {\n              currentGroup.max = max;\n            }\n            calcRow.keyframes.push(calcKeyframe);\n            currentGroup.keyframes.push(calcKeyframe);\n            toReturn.keyframes.push(calcKeyframe);\n          }\n        });\n      }\n\n      calcRow.groups.forEach((group) => {\n        // Extend row min max bounds by a group bounds:\n        TimelineUtils.setMinMax(calcRow, group, true);\n        // get group screen coords\n        const groupRect = this._getKeyframesGroupSize(row, calcRow.size.y, group.min, group.max);\n        group.size = groupRect;\n      });\n\n      // Extend screen bounds by a current calculation:\n      TimelineUtils.setMinMax(toReturn, calcRow, true);\n    });\n    if (TimelineUtils.isNumber(toReturn.max)) {\n      toReturn.size.width = this.valToPx(toReturn.max);\n    }\n    return toReturn;\n  }\n\n  _renderRows(): void {\n    const data = this._calculateModel();\n    if (data && data.rows) {\n      this._ctx.save();\n      data.rows.forEach((rowCalc) => {\n        if (!rowCalc) {\n          return;\n        }\n\n        this._ctx.fillStyle = TimelineStyleUtils.getRowFillColor(rowCalc.model, this._options);\n        //this._ctx.fillRect(data.areaRect.x, data.areaRect.y, data.areaRect.w, data.areaRect.h);\n        // Note: bounds used instead of the clip while clip is slow!\n        const bounds = this._cutBounds(rowCalc.size);\n        if (bounds) {\n          this._ctx.fillRect(bounds.x, bounds.y, bounds.width, bounds.height);\n        }\n\n        const keyframeLaneColor = TimelineStyleUtils.groupFillColor(rowCalc.model, this._options);\n        if (!rowCalc.groups) {\n          return;\n        }\n        rowCalc.groups.forEach((group) => {\n          // get the bounds on a canvas\n          const rectBounds = this._cutBounds(group.size);\n          if (rectBounds) {\n            this._ctx.fillStyle = keyframeLaneColor;\n            this._ctx.fillRect(rectBounds.x, rectBounds.y, rectBounds.width, rectBounds.height);\n          }\n        });\n      });\n\n      this._ctx.restore();\n    }\n  }\n\n  /**\n   * Method is used for the optimization.\n   * Only visible part should be rendered.\n   */\n  _cutBounds(rect: DOMRect): TimelineCutBoundsRectResults {\n    if (!rect) {\n      return null;\n    }\n    // default bounds: minX, maxX, minY, maxY\n    const minX = 0,\n      maxX = this._width(),\n      minY = TimelineStyleUtils.headerHeight(this._options),\n      maxY = this._width();\n\n    if (\n      TimelineUtils.isRectOverlap(rect, {\n        x: minX,\n        y: minY,\n        width: TimelineUtils.getDistance(minX, maxX),\n        height: TimelineUtils.getDistance(minY, maxY),\n      } as DOMRect)\n    ) {\n      const y = Math.max(rect.y, minY);\n      const x = Math.max(rect.x, minX);\n      const offsetW = rect.x - x;\n      const offsetH = rect.y - y;\n\n      return {\n        height: rect.height + offsetH,\n        width: rect.width + offsetW,\n        x: x,\n        y: y,\n        overlapY: Math.abs(offsetH) > 0,\n        overlapX: Math.abs(offsetW) > 0,\n      } as TimelineCutBoundsRectResults;\n    }\n    return null;\n  }\n\n  /**\n   * get keyframe group screen rect coordinates.\n   * @param row\n   * @param rowY row screen coords y position\n   */\n  _getKeyframesGroupSize(row: TimelineRow, rowY: number, minValue: number, maxValue: number): DOMRect {\n    let groupHeight: number | string = TimelineStyleUtils.rowGroupHeight(row, this._options);\n\n    const height = TimelineStyleUtils.getRowHeight(row, this._options);\n    if ((!groupHeight && groupHeight !== 0) || isNaN(groupHeight as number) || groupHeight == 'auto') {\n      groupHeight = Math.floor(height * 0.7);\n    }\n\n    if (groupHeight > height) {\n      groupHeight = height;\n    }\n\n    const margin = height - (groupHeight as number);\n    // draw keyframes rows.\n    const xMin = this._toScreenPx(minValue); // local\n    const xMax = this._toScreenPx(maxValue); // local\n\n    return {\n      x: xMin,\n      y: rowY + Math.floor(margin / 2),\n      height: groupHeight,\n      width: TimelineUtils.getDistance(xMin, xMax),\n    } as DOMRect;\n  }\n\n  _getKeyframePosition(keyframe: TimelineKeyframe, rowCalculated: TimelineCalculatedRow): DOMRect | null {\n    if (!keyframe) {\n      console.log('keyframe should be defined.');\n      return null;\n    }\n\n    const val = keyframe.val;\n    if (isNaN(val)) {\n      return null;\n    }\n\n    const rowSize = rowCalculated.size;\n    // get center of the lane:\n    const y = rowSize.y + rowSize.height / 2;\n\n    let height: number | string = TimelineStyleUtils.getKeyframeStyle(keyframe, rowCalculated.model, this._options, 'height', 'auto');\n    let width: number | string = TimelineStyleUtils.getKeyframeStyle(keyframe, rowCalculated.model, this._options, 'width', 'auto');\n\n    if (height == 'auto') {\n      height = rowSize.height / 3;\n    }\n    if (width == 'auto') {\n      width = height;\n    }\n    if (height > 0) {\n      if (!isNaN(val)) {\n        return {\n          x: Math.floor(this._toScreenPx(val)), // local\n          y: Math.floor(y),\n          height: height,\n          width: width,\n        } as DOMRect;\n      }\n    }\n\n    return null;\n  }\n\n  _renderKeyframes(): void {\n    this._forEachKeyframe((calcKeyframe): boolean => {\n      const row = calcKeyframe.parentRow.model;\n      const pos = calcKeyframe.size;\n      const keyframe = calcKeyframe.model;\n      if (pos) {\n        let x = this._getSharp(pos.x);\n        let y = pos.y;\n        const bounds = this._cutBounds({\n          x: x - pos.width / 2,\n          y: y - pos.height / 2,\n          width: pos.width,\n          height: pos.height,\n        } as DOMRect);\n        if (!bounds) {\n          return;\n        }\n\n        this._ctx.save();\n\n        // Performance FIX: use clip only  when we are in the collision! Clip is slow!\n        // Other keyframes should be hidden by bounds check.\n        if (bounds && bounds.overlapY) {\n          this._ctx.beginPath();\n          this._ctx.rect(0, TimelineStyleUtils.headerHeight(this._options), this._width(), this._width());\n          this._ctx.clip();\n        }\n\n        const shape = TimelineStyleUtils.keyframeShape(keyframe, row, this._options);\n        if (shape === TimelineKeyframeShape.None) {\n          return;\n        }\n\n        const keyframeColor = keyframe.selected ? TimelineStyleUtils.keyframeSelectedFillColor(keyframe, row, this._options) : TimelineStyleUtils.keyframeFillColor(keyframe, row, this._options);\n        const border = TimelineStyleUtils.keyframeStrokeThickness(keyframe, row, this._options);\n        let strokeColor = '';\n        if (border > 0) {\n          if (keyframe.selected) {\n            strokeColor = TimelineStyleUtils.keyframeSelectedStrokeColor(keyframe, row, this._options);\n          } else {\n            strokeColor = TimelineStyleUtils.keyframeStrokeColor(keyframe, row, this._options);\n          }\n        }\n\n        if (shape == TimelineKeyframeShape.Rhomb) {\n          this._ctx.beginPath();\n          this._ctx.translate(x, y);\n          this._ctx.rotate((45 * Math.PI) / 180);\n          if (border > 0 && strokeColor) {\n            this._ctx.fillStyle = strokeColor;\n            this._ctx.rect(-pos.width / 2, -pos.height / 2, pos.width, pos.height);\n            this._ctx.fill();\n          }\n\n          this._ctx.fillStyle = keyframeColor;\n          // draw main keyframe data with offset.\n          this._ctx.translate(border, border);\n          this._ctx.rect(-pos.width / 2, -pos.height / 2, pos.width - border * 2, pos.height - border * 2);\n          this._ctx.fill();\n        } else if (shape == TimelineKeyframeShape.Circle) {\n          this._ctx.beginPath();\n          if (border > 0 && strokeColor) {\n            this._ctx.fillStyle = strokeColor;\n            this._ctx.arc(x, y, pos.height, 0, 2 * Math.PI);\n          }\n          this._ctx.fillStyle = keyframeColor;\n          this._ctx.arc(x, y, pos.height - border, 0, 2 * Math.PI);\n          this._ctx.fill();\n        } else if (shape == TimelineKeyframeShape.Rect) {\n          this._ctx.beginPath();\n          y = y - pos.height / 2;\n          x = x - pos.width / 2;\n          if (border > 0 && strokeColor) {\n            this._ctx.fillStyle = strokeColor;\n            this._ctx.rect(x, y, pos.width, pos.height);\n            this._ctx.fill();\n          }\n\n          this._ctx.fillStyle = keyframeColor;\n          this._ctx.rect(x + border, y + border, pos.width - border, pos.height - border);\n          this._ctx.fill();\n        }\n\n        this._ctx.restore();\n      }\n    });\n  }\n\n  _renderSelectionRect(): void {\n    if (this._drag) {\n      return;\n    }\n\n    this._ctx.save();\n    const thickness = 1;\n    if (this._selectionRect && this._selectionRectEnabled) {\n      this._ctx.setLineDash([4]);\n      this._ctx.lineWidth = this._pixelRatio;\n      this._ctx.strokeStyle = this._options.selectionColor;\n      this._ctx.strokeRect(\n        this._getSharp(this._selectionRect.x, thickness),\n        this._getSharp(this._selectionRect.y, thickness),\n        Math.floor(this._selectionRect.width),\n        Math.floor(this._selectionRect.height),\n      );\n    }\n    this._ctx.restore();\n  }\n\n  _renderBackground(): void {\n    if (this._options.fillColor) {\n      this._ctx.save();\n      this._ctx.beginPath();\n      this._ctx.rect(0, 0, this._width(), this._height());\n      this._ctx.fillStyle = this._options.fillColor;\n      this._ctx.fill();\n      this._ctx.restore();\n    } else {\n      // Clear if bg not set.\n      this._ctx.clearRect(0, 0, this._canvas.width, this._canvas.height);\n    }\n  }\n\n  _renderTimeline(): void {\n    if (!this._ctx || !this._options || !this._options.timelineStyle) {\n      return;\n    }\n    const style = this._options.timelineStyle;\n    this._ctx.save();\n    const thickness = style.width || 1;\n    this._ctx.lineWidth = thickness * this._pixelRatio;\n    const timeLinePos = this._getSharp(this._toScreenPx(this._val), thickness);\n    this._ctx.strokeStyle = style.strokeColor;\n    this._ctx.fillStyle = style.fillColor;\n    const y = style.marginTop;\n    this._ctx.beginPath();\n    TimelineUtils.drawLine(this._ctx, timeLinePos, y, timeLinePos, this._height());\n    this._ctx.stroke();\n\n    if (style.capHeight && style.capWidth) {\n      const rectSize = style.capWidth;\n      const capHeight = style.capHeight;\n      if (style.capType === TimelineCapShape.Triangle) {\n        this._ctx.beginPath();\n        this._ctx.moveTo(timeLinePos - rectSize / 2, y);\n        this._ctx.lineTo(timeLinePos + rectSize / 2, y);\n        this._ctx.lineTo(timeLinePos, capHeight);\n        this._ctx.closePath();\n        this._ctx.stroke();\n      } else if (style.capType === TimelineCapShape.Rect) {\n        this._ctx.fillRect(timeLinePos - rectSize / 2, y, rectSize, capHeight);\n        this._ctx.fill();\n      }\n    }\n\n    this._ctx.restore();\n  }\n\n  _renderHeaderBackground(): void {\n    if (!this._ctx || !this._options) {\n      return;\n    }\n    if (TimelineStyleUtils.headerHeight(this._options)) {\n      this._ctx.save();\n      // draw ticks background\n      this._ctx.lineWidth = this._pixelRatio;\n      if (this._options.headerFillColor) {\n        // draw ticks background\n        this._ctx.lineWidth = this._pixelRatio;\n        // draw header background\n        this._ctx.fillStyle = this._options.headerFillColor;\n        this._ctx.fillRect(0, 0, this._width(), TimelineStyleUtils.headerHeight(this._options));\n      } else {\n        this._ctx.clearRect(0, 0, this._width(), TimelineStyleUtils.headerHeight(this._options));\n      }\n      this._ctx.restore();\n    }\n  }\n\n  redraw(): void {\n    if (window.requestAnimationFrame) {\n      window.requestAnimationFrame(this._redrawInternal);\n    } else {\n      this._redrawInternal();\n    }\n  }\n\n  /**\n   * perform scroll to max left.\n   */\n  public scrollLeft(): void {\n    if (this._scrollContainer.scrollLeft != this._scrollContainer.scrollWidth) {\n      this._scrollContainer.scrollLeft = this._scrollContainer.scrollWidth;\n    }\n  }\n\n  /**\n   * Redraw parts of the component in the specific order.\n   */\n  _redrawInternal = (): void => {\n    if (!this._ctx) {\n      return;\n    }\n    // Rescale when animation is played out of the bounds.\n    if (this.valToPx(this._val) > this._scrollContainer.scrollWidth) {\n      this.rescale();\n      if (!this._isPanStarted && this._drag && this._drag.type !== TimelineElementType.Timeline) {\n        this.scrollLeft();\n      }\n    }\n\n    this._renderBackground();\n    this._renderRows();\n    // Render after rows\n    this._renderHeaderBackground();\n    this._renderTicks();\n    this._renderKeyframes();\n    this._renderSelectionRect();\n    this._renderTimeline();\n  };\n\n  /**\n   * Get row by y coordinate.\n   * @param posY y screen coordinate.\n   */\n  public getRowByY(posY: number): TimelineRow {\n    const model = this._calculateModel();\n    if (model && model.rows) {\n      for (let i = 0; i < model.rows.length; i++) {\n        const row = model.rows[i].size;\n        if (row && row.y >= posY && posY <= row.y + row.height) {\n          return row;\n        }\n      }\n    }\n\n    return null;\n  }\n  /**\n   * Find sharp pixel position\n   */\n  _getSharp(pos: number, thickness = 1): number {\n    pos = Math.round(pos);\n    if (thickness % 2 == 0) {\n      return pos;\n    }\n\n    return pos + this._pixelRatio / 2;\n  }\n\n  /**\n   * Get current time:\n   */\n  public getTime(): number {\n    return this._val;\n  }\n\n  /**\n   * Set current time internal\n   * @param val value.\n   * @param source event source.\n   */\n  _setTimeInternal(val: number, source: TimelineEventSource = TimelineEventSource.Programmatically): boolean {\n    val = Math.round(val);\n    if (val < this._options.min) {\n      val = this._options.min;\n    }\n\n    if (this._val != val) {\n      const prevVal = this._val;\n      const timelineEvent = new TimelineTimeChangedEvent();\n      timelineEvent.val = val;\n      timelineEvent.prevVal = prevVal;\n      timelineEvent.source = source;\n      this._val = val;\n      this.emit(TimelineEvents.TimeChanged, timelineEvent);\n      if (timelineEvent.isPrevented()) {\n        this._val = prevVal;\n        return false;\n      }\n      return true;\n    }\n\n    return false;\n  }\n  public setTime(val: number): boolean {\n    // don't allow to change time during drag:\n    if (this._drag && this._drag.type === TimelineElementType.Timeline) {\n      return false;\n    }\n\n    const isChanged = this._setTimeInternal(val, TimelineEventSource.SetTimeMethod);\n    if (isChanged) {\n      this.rescale();\n      this.redraw();\n    }\n\n    return isChanged;\n  }\n\n  public getOptions(): TimelineOptions {\n    return this._options;\n  }\n\n  public setScrollLeft(value: number): void {\n    if (this._scrollContainer) {\n      this._scrollContainer.scrollLeft = value;\n    }\n  }\n  public setScrollTop(value: number): void {\n    if (this._scrollContainer) {\n      this._scrollContainer.scrollTop = value;\n    }\n  }\n  public getScrollLeft(): number {\n    return this._scrollContainer ? this._scrollContainer.scrollLeft : 0;\n  }\n  public getScrollTop(): number {\n    return this._scrollContainer ? this._scrollContainer.scrollTop : 0;\n  }\n\n  /**\n   * Set options and render the component.\n   * Options will be merged with the defaults and control invalidated\n   */\n  public setOptions(toSet: TimelineOptions): TimelineOptions {\n    this._options = this._setOptions(toSet);\n    this.rescale();\n    this.redraw();\n    // Merged options:\n    return this._options;\n  }\n\n  _setOptions(toSet: TimelineOptions): TimelineOptions {\n    this._options = this._mergeOptions(toSet);\n    // Normalize and validate spans per value.\n    this._options.snapStep = TimelineUtils.keepInBounds(this._options.snapStep, 0, this._options.stepVal || 0);\n    this._currentZoom = this._setZoom(this._options.zoom, this._options.zoomMin, this._options.zoomMax);\n    this._options.min = TimelineUtils.isNumber(this._options.min) ? this._options.min : 0;\n    this._options.max = TimelineUtils.isNumber(this._options.max) ? this._options.max : Number.MAX_VALUE;\n    if (this._scrollContainer) {\n      const classList = this._scrollContainer.classList;\n      if (this._options.scrollContainerClass && classList.contains(this._options.scrollContainerClass)) {\n        classList.add(this._options.scrollContainerClass);\n      }\n      if (this._options.fillColor) {\n        this._scrollContainer.style.background = this._options.fillColor;\n      }\n    }\n    return this._options;\n  }\n\n  public getModel(): TimelineModel {\n    return this._model;\n  }\n\n  /**\n   * Set model and redraw application.\n   * @param data\n   */\n  public setModel(data: TimelineModel): void {\n    this._model = data;\n    this.rescale();\n    this.redraw();\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  _getMousePos(canvas: HTMLCanvasElement, e: TouchEvent | MouseEvent | any): TimelineMouseData {\n    let radius = 1;\n    let clientX = 0;\n    let clientY = 0;\n    if (e.changedTouches && e.changedTouches.length > 0) {\n      // TODO: implement better touch support\n      const touch = e.changedTouches[0];\n      clientX = touch.clientX;\n      clientY = touch.clientY;\n      radius = Math.max(radius, touch.radiusX, touch.radiusY);\n    } else {\n      clientX = e.clientX;\n      clientY = e.clientY;\n    }\n\n    const rect = canvas.getBoundingClientRect(), // abs. size of element\n      scaleX = canvas.width / this._pixelRatio / rect.width, // relationship bitmap vs. element for X\n      scaleY = canvas.height / this._pixelRatio / rect.height; // relationship bitmap vs. element for Y\n\n    const x = (clientX - rect.left) * scaleX;\n    const y = (clientY - rect.top) * scaleY;\n    // scale mouse coordinates after they have been adjusted to be relative to element\n    return {\n      x: x,\n      y: y,\n      radius,\n      args: e,\n    } as TimelineMouseData;\n  }\n\n  /**\n   * Apply container div size to the container on changes detected.\n   */\n  _updateCanvasScale(): boolean {\n    if (!this._scrollContainer || !this._container || !this._ctx) {\n      console.log('Component should be initialized first');\n      return;\n    }\n    let changed = false;\n    const width = this._scrollContainer.clientWidth * this._pixelRatio;\n    const height = this._scrollContainer.clientHeight * this._pixelRatio;\n    if (Math.floor(width) != Math.floor(this._ctx.canvas.width)) {\n      this._ctx.canvas.width = width;\n      changed = true;\n    }\n\n    if (Math.floor(height) != Math.floor(this._ctx.canvas.height)) {\n      this._ctx.canvas.height = height;\n      changed = true;\n    }\n\n    if (changed) {\n      this._ctx.setTransform(this._pixelRatio, 0, 0, this._pixelRatio, 0, 0);\n    }\n    return changed;\n  }\n\n  /**\n   * Rescale and update size of the container.\n   */\n  public rescale(): void {\n    this._rescaleInternal();\n  }\n\n  _rescaleInternal(newWidth: number | null = null, newHeight: number | null = null, scrollMode = 'default'): void {\n    this._updateCanvasScale();\n    const data = this._calculateModel();\n    if (data && data.size) {\n      const additionalOffset = this._options.stepPx;\n      newWidth = newWidth || 0;\n      // not less than current timeline position\n      const timelineGlobalPos = this.valToPx(this._val);\n      let timelinePos = 0;\n      if (timelineGlobalPos > this._width()) {\n        if (scrollMode == 'scrollBySelection') {\n          timelinePos = Math.floor(timelineGlobalPos + this._width() + (this._options.stepPx || 0));\n        } else {\n          timelinePos = Math.floor(timelineGlobalPos + this._width() / 1.5);\n        }\n      }\n      const keyframeW = data.size.width + this._leftMargin() + additionalOffset;\n\n      newWidth = Math.max(\n        newWidth,\n        // keyframes size\n        keyframeW,\n        // not less than current scroll position\n        this.getScrollLeft() + this._width(),\n        timelinePos,\n      );\n\n      const minWidthPx = Math.floor(newWidth) + 'px';\n      if (minWidthPx != this._scrollContent.style.minWidth) {\n        this._scrollContent.style.minWidth = minWidthPx;\n      }\n\n      newHeight = Math.max(Math.floor(data.size.height + this._height() * 0.2), this._scrollContainer.scrollTop + this._height() - 1, Math.round(newHeight || 0));\n\n      const h = newHeight + 'px';\n      if (this._scrollContent.style.minHeight != h) {\n        this._scrollContent.style.minHeight = h;\n      }\n    }\n  }\n\n  /**\n   * get draggable element.\n   * Filter elements and get first element by a priority.\n   * @param Array\n   * @param val current mouse value\n   */\n  _findDraggable(elements: Array<TimelineElement>, val: number | null = null): TimelineElement {\n    // filter and sort: Timeline, individual keyframes, groups (distance).\n    const getPriority = (type: TimelineElementType): number => {\n      if (type === TimelineElementType.Timeline) {\n        return 1;\n      } else if (type === TimelineElementType.Keyframe) {\n        return 2;\n      } else if (type === TimelineElementType.Group) {\n        return 3;\n      }\n      return -1;\n    };\n    const filteredElements = elements.filter((element) => {\n      if (!element) {\n        return false;\n      }\n      if (element.type === TimelineElementType.Keyframe) {\n        if (!TimelineStyleUtils.keyframeDraggable(element.keyframe, element.row, this._options)) {\n          return false;\n        }\n      } else if (element.type === TimelineElementType.Group) {\n        if (!TimelineStyleUtils.groupDraggable(element.row, this._options)) {\n          return false;\n        }\n      } else if (element.type === TimelineElementType.Row) {\n        return false;\n      }\n      return true;\n    });\n    const sortDraggable = (a: TimelineElement, b: TimelineElement): number => {\n      let prioA = getPriority(a.type);\n      let prioB = getPriority(b.type);\n      if (prioA === prioB) {\n        if (val === null) {\n          return 0;\n        }\n\n        // Sort by distance\n        prioA = TimelineUtils.getDistance(a.val, val);\n        prioB = TimelineUtils.getDistance(b.val, val);\n        if (prioA === prioB) {\n          return 0;\n        }\n        return prioA < prioB ? 1 : -1;\n      }\n\n      return prioA < prioB ? 1 : -1;\n    };\n    const sorted = filteredElements.sort(sortDraggable);\n    if (sorted.length > 0) {\n      return sorted[sorted.length - 1];\n    }\n\n    return null;\n  }\n\n  /**\n   * get all clickable elements by a screen point.\n   */\n  public elementFromPoint(pos: DOMPoint, clickRadius = 2): Array<TimelineElement> {\n    clickRadius = Math.max(clickRadius, 1);\n    const toReturn: Array<TimelineElement> = [];\n\n    if (!pos) {\n      return toReturn;\n    }\n\n    const headerHeight = TimelineStyleUtils.headerHeight(this._options);\n    // Check whether we can drag timeline.\n    const timeLinePos = this._toScreenPx(this._val);\n    let width = 0;\n    if (this._options && this._options.timelineStyle) {\n      const timelineStyle = this._options.timelineStyle;\n      width = Math.max((timelineStyle.width || 1) * this._pixelRatio, (timelineStyle.capWidth || 0) * this._pixelRatio || 1) + clickRadius;\n    }\n    // Allow to select timeline only by half of a header to allow select by a selector top most keyframes row.\n    if (pos.y <= headerHeight * 0.5 || (pos.x >= timeLinePos - width / 2 && pos.x <= timeLinePos + width / 2)) {\n      toReturn.push({\n        val: this._val,\n        type: TimelineElementType.Timeline,\n      } as TimelineElement);\n    }\n    const snap = this._options.snapEnabled;\n    if (pos.y >= headerHeight && this._options.keyframesDraggable) {\n      this._forEachKeyframe((calcKeyframe, index, isNextRow): void => {\n        // Check keyframes group overlap\n        if (isNextRow) {\n          const rowOverlapped = TimelineUtils.isOverlap(pos.x, pos.y, calcKeyframe.parentRow.size);\n          if (rowOverlapped) {\n            const row = {\n              val: this._mousePosToVal(pos.x, snap),\n              keyframes: calcKeyframe.parentRow.model.keyframes,\n              type: TimelineElementType.Row,\n              row: calcKeyframe.parentRow.model,\n            } as TimelineElement;\n            toReturn.push(row);\n          }\n          if (calcKeyframe.parentRow.groups) {\n            calcKeyframe.parentRow.groups.forEach((group) => {\n              const keyframesGroupOverlapped = TimelineUtils.isOverlap(pos.x, pos.y, group.size);\n              if (keyframesGroupOverlapped) {\n                const keyframesModels = this._mapKeyframes(group.keyframes);\n                const groupElement = {\n                  val: this._mousePosToVal(pos.x, snap),\n                  type: TimelineElementType.Group,\n                  group: group,\n                  row: calcKeyframe.parentRow.model,\n                  keyframes: keyframesModels,\n                } as TimelineElement;\n\n                const snapped = this.snapVal(group.min);\n                // get snapped mouse pos based on a min value.\n                groupElement.val += group.min - snapped;\n                toReturn.push(groupElement);\n              }\n            });\n          }\n        }\n\n        const keyframePos = calcKeyframe.size;\n        if (keyframePos) {\n          const dist = TimelineUtils.getDistance(keyframePos.x, keyframePos.y, pos.x, pos.y);\n          if (dist <= keyframePos.height + clickRadius) {\n            toReturn.push({\n              keyframe: calcKeyframe.model,\n              keyframes: [calcKeyframe.model],\n              val: calcKeyframe.model.val,\n              row: calcKeyframe.parentRow.model,\n              type: TimelineElementType.Keyframe,\n            } as TimelineElement);\n          }\n        }\n      });\n    }\n    return toReturn;\n  }\n\n  /**\n   * Merge options with the defaults.\n   */\n  _mergeOptions(fromArg: TimelineOptions): TimelineOptions {\n    fromArg = fromArg || ({} as TimelineOptions);\n    // Apply incoming options to default. (override default)\n    // Deep clone default options:\n    const toArg = JSON.parse(JSON.stringify(defaultTimelineOptions));\n    // Merge options with the default.\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const mergeOptionsDeep = (to: any, from: any): void => {\n      if (!to || !from) {\n        return;\n      }\n      // eslint-disable-next-line prefer-const\n      for (let key in from) {\n        if (Object.prototype.hasOwnProperty.call(from, key)) {\n          if (from[key] !== undefined) {\n            if (typeof from[key] === 'object') {\n              if (!to[key]) {\n                to[key] = from[key];\n              } else {\n                mergeOptionsDeep(to[key], from[key]);\n              }\n            } else {\n              to[key] = from[key];\n            }\n          }\n        }\n      }\n    };\n\n    mergeOptionsDeep(toArg, fromArg);\n    return toArg;\n  }\n  /**\n   * Subscribe on time changed.\n   */\n  public onTimeChanged(callback: (eventArgs: TimelineTimeChangedEvent) => void): void {\n    this.on(TimelineEvents.TimeChanged, callback);\n  }\n  /**\n   * Subscribe on drag started event.\n   */\n  public onDragStarted(callback: (eventArgs: TimelineDragEvent) => void): void {\n    this.on(TimelineEvents.DragStarted, callback);\n  }\n  /**\n   * Subscribe on drag event.\n   */\n  public onDrag(callback: (eventArgs: TimelineDragEvent) => void): void {\n    this.on(TimelineEvents.Drag, callback);\n  }\n  /**\n   * Subscribe on drag finished event.\n   */\n  public onDragFinished(callback: (eventArgs: TimelineDragEvent) => void): void {\n    this.on(TimelineEvents.DragFinished, callback);\n  }\n  /**\n   * Subscribe on double click.\n   */\n  public onDoubleClick(callback: (eventArgs: TimelineClickEvent) => void): void {\n    this.on(TimelineEvents.DoubleClick, callback);\n  }\n  /**\n   * Subscribe on keyframe changed event.\n   */\n  public onKeyframeChanged(callback: (eventArgs: TimelineKeyframeChangedEvent) => void): void {\n    this.on(TimelineEvents.KeyframeChanged, callback);\n  }\n  /**\n   * Subscribe on drag finished event.\n   */\n  public onMouseDown(callback: (eventArgs: TimelineClickEvent) => void): void {\n    this.on(TimelineEvents.MouseDown, callback);\n  }\n\n  public onSelected(callback: (eventArgs: TimelineSelectedEvent) => void): void {\n    this.on(TimelineEvents.Selected, callback);\n  }\n  /**\n   * Subscribe on scroll event\n   */\n  public onScroll(callback: (eventArgs: TimelineScrollEvent) => void): void {\n    this.on(TimelineEvents.Scroll, callback);\n  }\n  _emitScrollEvent(args: MouseEvent | null): TimelineScrollEvent {\n    const scrollEvent = {\n      args: args,\n      scrollLeft: this.getScrollLeft(),\n      scrollTop: this.getScrollTop(),\n      scrollHeight: this._scrollContainer.scrollHeight,\n      scrollWidth: this._scrollContainer.scrollWidth,\n    } as TimelineScrollEvent;\n    super.emit(TimelineEvents.Scroll, scrollEvent);\n    return scrollEvent;\n  }\n  _emitKeyframeChanged(element: TimelineElementDragState, source: TimelineEventSource = TimelineEventSource.Programmatically): TimelineKeyframeChangedEvent {\n    const args = new TimelineKeyframeChangedEvent();\n    args.val = element.val;\n    args.prevVal = element.prevVal;\n    args.target = element;\n    args.source = source;\n    this.emit(TimelineEvents.KeyframeChanged, args);\n    return args;\n  }\n  _emitDragStartedEvent(): TimelineDragEvent {\n    const args = this._getDragEventArgs();\n    this.emit(TimelineEvents.DragStarted, args);\n    if (args.isPrevented()) {\n      this._preventDrag(args, this._drag, true);\n    }\n    return args;\n  }\n  _emitDragFinishedEvent(): TimelineDragEvent {\n    if (this._drag && this._drag.changed) {\n      const args = this._getDragEventArgs();\n      this.emit(TimelineEvents.DragFinished, args);\n      if (args.isPrevented()) {\n        this._preventDrag(args, this._drag, true);\n      }\n      return args;\n    }\n\n    return null;\n  }\n  _preventDrag(dragArgs: TimelineDragEvent, data: TimelineDraggableData, toStart = false): void {\n    if (dragArgs.elements) {\n      dragArgs.elements.forEach((element) => {\n        const toSet = toStart ? element.startedVal : element.prevVal;\n        this._setKeyframePos(element, toSet);\n      });\n    }\n    data.val = data.prevVal;\n    dragArgs.val = dragArgs.prevVal;\n  }\n  _emitDragEvent(): TimelineDragEvent {\n    if (!this._drag) {\n      return null;\n    }\n    const args = this._getDragEventArgs();\n    this.emit(TimelineEvents.Drag, args);\n    if (args.isPrevented()) {\n      this._preventDrag(args, this._drag, false);\n    }\n    return args;\n  }\n  _emitKeyframesSelected(state: TimelineSelectionResults): TimelineSelectedEvent {\n    const args = new TimelineSelectedEvent();\n    args.selected = state.selected;\n    args.changed = state.changed;\n    this.emit(TimelineEvents.Selected, args);\n    return args;\n  }\n  _getDragEventArgs(): TimelineDragEvent {\n    const draggableArguments = new TimelineDragEvent();\n    if (!this._drag) {\n      return draggableArguments;\n    }\n    draggableArguments.val = this._currentPos.val;\n    draggableArguments.originalVal = this._currentPos.originalVal;\n    draggableArguments.snapVal = this._currentPos.snapVal;\n    draggableArguments.pos = this._currentPos;\n    draggableArguments.elements = this._drag.elements;\n    draggableArguments.target = this._drag.target;\n    return draggableArguments;\n  }\n}\n","// bundle entry point\n\nexport * from './timeline';\nexport * from './timelineModel';\nexport * from './timelineRow';\nexport * from './timelineKeyframe';\nexport * from './timelineEventsEmitter';\nexport * from './settings/timelineConsts';\nexport * from './timelineRanged';\n\n// @public styles\nexport * from './settings/timelineOptions';\nexport * from './settings/styles/timelineKeyframeStyle';\nexport * from './settings/styles/timelineRowStyle';\nexport * from './settings/styles/timelineStyle';\n\nexport * from './utils/timelineStyleUtils';\nexport * from './utils/timelineUtils';\nexport * from './utils/timelineElement';\n\n// @private helper containers.\nexport * from './utils/selectable';\nexport * from './utils/timelineCutBoundsRectResults';\nexport * from './utils/timelineSelectionResults';\nexport * from './utils/timelineValues';\nexport * from './utils/timelineMouseData';\nexport * from './utils/timelineElementDragState';\nexport * from './utils/timelineDraggableData';\n\n// @private virtual model\nexport * from './utils/timelineModelCalcResults';\nexport * from './utils/timelineCalculatedRow';\nexport * from './utils/timelineCalculatedGroup';\nexport * from './utils/timelineCalculated';\nexport * from './utils/timelineCalculatedKeyframe';\n\n// @public events\nexport * from './utils/events/timelineKeyframeChangedEvent';\nexport * from './utils/events/timelineTimeChangedEvent';\nexport * from './utils/events/timelineSelectedEvent';\nexport * from './utils/events/timelineScrollEvent';\nexport * from './utils/events/timelineClickEvent';\nexport * from './utils/events/timelineDragEvent';\n\n// @public enums\nexport * from './enums/timelineKeyframeShape';\nexport * from './enums/timelineInteractionMode';\nexport * from './enums/timelineElementType';\nexport * from './enums/timelineCursorType';\nexport * from './enums/timelineCapShape';\nexport * from './enums/timelineEventSource';\nexport * from './enums/timelineSelectionMode';\nexport * from './enums/timelineEvents';\n// @private defaults are exposed:\nexport * from './settings/defaults';\n"],"names":["TimelineEventsEmitter","topic","callback","_subscriptions","push","filter","event","length","args","forEach","TimelineKeyframeShape","TimelineStyleUtils","keyframeStyle","rowStyle","options","propertyName","defaultValue","reverseOrder","styles","style","undefined","value","keyframesStyle","globalRowStyle","rowsStyle","results","keyframe","shape","getKeyframeStyle","Rhomb","color","getRowStyle","headerHeight","denominators","TimelineUtils","ctx","x1","y1","x2","y2","moveTo","lineTo","val","isNaN","Number","isFinite","array","element","index","indexOf","splice","x","y","rectangle","width","height","originalStep","divisionCheck","step","lastDistance","pow","getPowArgument","i","denominator","calculatedStep","Math","distance","getDistance","min","max","isNumber","to","from","shrink","fromMin","getMin","toMin","isFromMinNumber","isToMinNumber","fromMax","getMax","toMax","isFromMaxNumber","isToMaxNumber","rect","rect2","console","log","sqrt","abs","p","window","getSelection","removeAllRanges","doc","document","selection","empty","toCheck","category","s","sign","floor","zerosCount","TimelineBaseEvent","_prevented","TimelineKeyframeChangedEvent","TimelineEventSource","TimelineTimeChangedEvent","User","TimelineSelectedEvent","TimelineClickEvent","TimelineDragEvent","TimelineInteractionMode","TimelineElementType","TimelineCursorType","TimelineCapShape","TimelineSelectionMode","TimelineEvents","defaultTimelineStyle","marginTop","capWidth","capHeight","capType","Rect","strokeColor","fillColor","defaultTimelineKeyframeStyle","selectedFillColor","selectedStrokeColor","strokeThickness","draggable","defaultTimelineRowStyle","marginBottom","groupFillColor","groupHeight","defaultTimelineOptions","snapAllKeyframesOnMove","snapEnabled","timelineStyle","stepPx","stepVal","stepSmallPx","snapStep","leftMargin","headerFillColor","labelsColor","tickColor","selectionColor","font","zoom","zoomSpeed","zoomMin","zoomMax","controlKeyIsMetaKey","scrollContainerClass","groupsDraggable","keyframesDraggable","MAX_VALUE","defaultTimelineConsts","autoPanSpeed","scrollByDragSpeed","clickDetectionMs","doubleClickTimeoutMs","scrollFinishedTimeoutMs","autoPanByScrollPadding","clickThreshold","Timeline","model","Selection","_interactionMode","Zoom","_setZoomCursor","_cleanUpSelection","rescale","redraw","_clearScrollFinishedTimer","_scrollFinishedTimerRef","setTimeout","_isPanStarted","clearTimeout","_consts","_emitScrollEvent","_controlKeyPressed","preventDefault","mousePos","_getMousePos","_canvas","_zoom","deltaY","_options","_scrollContainer","scrollTop","isDoubleClick","Date","now","_lastClickTime","clearBrowserSelection","_startPos","_trackMousePos","_lastClickPoint","_scrollStartPos","scrollLeft","_clickAllowed","elements","elementFromPoint","radius","target","_findDraggable","pos","originalVal","snapVal","DoubleClick","MouseDown","_clickTimeout","isPrevented","_currentPos","_drag","changed","_setElementDragState","type","Keyframe","_startedDragWithCtrl","_startedDragWithShiftKey","shiftKey","selected","_selectInternal","getSelectedElements","map","Group","keyframes","Array","isArray","_convertToElement","row","_lastUsedArgs","isTouch","changedTouches","_selectionRect","_clickTimeoutIsOver","_selectionRectEnabled","isLeftClicked","isLeftButtonClicked","convertedVal","_setTimeInternal","offset","movedOffset","_moveElements","prevVal","eventArgs","_emitDragStartedEvent","_emitDragEvent","Pan","_setCursor","Grabbing","_scrollByPan","_scrollBySelectionOutOfBounds","Grab","Default","cursor","EWResize","Pointer","direction","_performClick","_getKeyframesByRectangle","selectionMode","Append","Normal","select","_ctx","valToPx","_val","scrollWidth","_renderBackground","_renderRows","_renderHeaderBackground","_renderTicks","_renderKeyframes","_renderSelectionRect","_renderTimeline","initialize","_model","id","Error","_generateContainers","_setOptions","_subscribeOnEvents","HTMLElement","_container","getElementById","createElement","_scrollContent","getContext","position","cssText","appendChild","scrollBarWidth","offsetWidth","clientWidth","addEventListener","_handleWheelEvent","_handleScrollEvent","_handleKeyUp","_handleKeyDown","_handleBlurEvent","_handleWindowResizeEvent","_handleMouseDownEvent","_handleMouseMoveEvent","_handleMouseUpEvent","offAll","removeEventListener","_stopAutoPan","e","ZoomOut","ZoomIn","metaKey","ctrlKey","speed","deltaSpeed","_width","diff","_fromScreen","_currentZoom","_setZoom","zoomCenter","newScrollLeft","round","_rescaleInternal","keepInBounds","prevZoom","getZoom","zoomSet","state","startedVal","buttons","source","Programmatically","isChanged","bounds","MIN_SAFE_INTEGER","MAX_SAFE_INTEGER","setMinMax","currentBounds","expectedKeyframeValue","newPosition","toSet","newValue","_setKeyframePos","clientHeight","screenRect","keyframesModels","_forEachKeyframe","calcKeyframe","isOverlap","size","drag","mode","Revert","selectionChanged","_emitKeyframeChanged","data","_mapKeyframes","parentRow","getAllKeyframes","node","selectable","nodes","getSelectedKeyframes","nodesArray","_changeNodeState","deleteElement","selectedItems","exists","_emitKeyframesSelected","calculatedModel","_calculateModel","rows","calcRow","nextRow","keyframeIndex","canvas","mouseArgs","_mousePosToVal","getScrollLeft","getScrollTop","_emitDragFinishedEvent","_intervalRef","setInterval","clearInterval","_autoPanLastActionDate","start","scrollStartPos","offsetX","newLeft","speedX","speedY","isLeft","isRight","isTop","isBottom","_height","newWidth","newHeight","_startAutoPan","_checkUpdateSpeedTooFast","scrollSpeedMultiplier","px","steps","_leftMargin","pxToVal","stops","stepsFit","minSteps","minOffset","ms","isSeconds","seconds","year","days","hours","minutes","str","rulerActive","screenWidth","wasToVal","valDistance","findGoodStep","smallStep","fromVal","toVal","ceil","lastTextStart","save","tickHeight","smallTickHeight","sharpPos","_getSharp","_toScreenPx","beginPath","setLineDash","lineWidth","strokeStyle","drawLine","stroke","fillStyle","text","_formatUnitsText","textSize","measureText","textX","fillText","restore","nextSharpPos","_pixelRatio","toReturn","rowAbsoluteHeight","hidden","rowHeight","getRowHeight","getRowMarginBottom","currentRowY","groups","currentGroup","existingGroup","group","keyframeSize","_getKeyframePosition","parentGroup","groupRect","_getKeyframesGroupSize","rowCalc","getRowFillColor","_cutBounds","fillRect","keyframeLaneColor","rectBounds","minX","maxX","minY","maxY","isRectOverlap","offsetW","offsetH","overlapY","overlapX","rowY","minValue","maxValue","rowGroupHeight","margin","xMin","xMax","rowCalculated","rowSize","clip","keyframeShape","None","keyframeColor","keyframeSelectedFillColor","keyframeFillColor","border","keyframeStrokeThickness","keyframeSelectedStrokeColor","keyframeStrokeColor","translate","rotate","PI","fill","Circle","arc","thickness","strokeRect","clearRect","timeLinePos","rectSize","Triangle","closePath","requestAnimationFrame","_redrawInternal","posY","timelineEvent","emit","TimeChanged","SetTimeMethod","_mergeOptions","classList","contains","add","background","clientX","clientY","touch","radiusX","radiusY","getBoundingClientRect","scaleX","scaleY","left","top","setTransform","scrollMode","_updateCanvasScale","additionalOffset","timelineGlobalPos","timelinePos","keyframeW","minWidthPx","minWidth","h","minHeight","getPriority","filteredElements","keyframeDraggable","groupDraggable","Row","sortDraggable","a","b","prioA","prioB","sorted","sort","clickRadius","snap","isNextRow","rowOverlapped","keyframesGroupOverlapped","groupElement","snapped","keyframePos","dist","fromArg","toArg","JSON","parse","stringify","mergeOptionsDeep","key","Object","prototype","hasOwnProperty","call","on","DragStarted","Drag","DragFinished","KeyframeChanged","Selected","Scroll","scrollEvent","scrollHeight","_getDragEventArgs","_preventDrag","dragArgs","toStart","draggableArguments"],"sourceRoot":""}
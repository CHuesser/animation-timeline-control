!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.timelineModule=t():e.timelineModule=t()}(window,(function(){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=11)}([function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,i){"use strict";function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}i.r(t),i.d(t,"Timeline",(function(){return E})),i.d(t,"TimelineModel",(function(){return D})),i.d(t,"TimelineOptions",(function(){return u})),i.d(t,"TimelineRow",(function(){return W.TimelineRow})),i.d(t,"TimelineStyleUtils",(function(){return x})),i.d(t,"TimelineKeyframe",(function(){return K.TimelineKeyframe})),i.d(t,"TimelineEventsEmitter",(function(){return o})),i.d(t,"TimelineUtils",(function(){return c})),i.d(t,"TimelineDraggableData",(function(){return L.TimelineDraggableData})),i.d(t,"SelectionTuple",(function(){return z.SelectionTuple})),i.d(t,"Selectable",(function(){return O.Selectable})),i.d(t,"RowsCalculationsResults",(function(){return V.RowsCalculationsResults})),i.d(t,"CutBoundsRect",(function(){return B.CutBoundsRect})),i.d(t,"TimelineSelectedEvent",(function(){return H.TimelineSelectedEvent})),i.d(t,"TimelineScrollEvent",(function(){return N.TimelineScrollEvent})),i.d(t,"TimelineConsts",(function(){return v})),i.d(t,"TimelineKeyframeStyle",(function(){return F.TimelineKeyframeStyle})),i.d(t,"TimelineRowStyle",(function(){return A.TimelineRowStyle})),i.d(t,"TimelineKeyframeShape",(function(){return s})),i.d(t,"TimelineInteractionMode",(function(){return g})),i.d(t,"TimelineEvents",(function(){return p})),i.d(t,"TimelineDraggableType",(function(){return y})),i.d(t,"TimelineCursorType",(function(){return d})),i.d(t,"TimelineCapShape",(function(){return l}));var o=function(){function e(){var t,i,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n=[],(i="_subscriptions")in(t=this)?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n}var t,i,o;return t=e,(i=[{key:"on",value:function(e,t){t&&this._subscriptions.push({topic:e,callback:t})}},{key:"off",value:function(e,t){this._subscriptions=this._subscriptions.filter((function(i){return i&&i.callback!=t&&i.topic!=e}))}},{key:"offAll",value:function(){this._subscriptions.length=0}},{key:"emit",value:function(e,t){this._subscriptions.forEach((function(i){i&&i.topic==e&&i.callback&&i.callback(t)}))}}])&&n(t.prototype,i),o&&n(t,o),e}();function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s,l,a=[1,2,5,10],c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i,n;return t=e,n=[{key:"drawLine",value:function(e,t,i,n,o){e.moveTo(t,i),e.lineTo(n,o)}},{key:"isOverlap",value:function(e,t,i){return i?i.x<=e&&i.x+i.width>=e&&i.y<=t&&i.y+i.height>=t:(console.error("rectangle argument cannot be empty"),!1)}},{key:"findGoodStep",value:function(t){for(var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t,o=null,r=e.getPowArgument(t),s=0;s<a.length;s++){var l=a[s],c=l*Math.pow(10,r);if(!i||i%c==0){var h=e.getDistance(t,c);if(0==h||h<=.1&&r>0){o=h,n=c;break}(!o||o>h)&&(o=h,n=c)}}return n}},{key:"isRectOverlap",value:function(e,t){return e&&t?e.x>t.x+t.width||t.x>e.x+e.width||e.y<t.y+t.height||t.y<e.y+e.height:(console.log("Rectangles cannot be empty"),!1)}},{key:"getDistance",value:function(e,t,i,n){return null!=i&&null!=n?Math.sqrt(Math.pow(e-i,2)+Math.pow(t-n,2)):Math.abs(e-t)}},{key:"sign",value:function(e){return e>=0?1:-1}},{key:"clearBrowserSelection",value:function(){if(window)if(window.getSelection)window.getSelection().removeAllRanges();else{var e=window.document;e.selection&&e.selection.empty()}}},{key:"getPowArgument",value:function(e){if(!e||0===e||!isFinite(e))return 1;if(e>=10&&e<100)return 1;if(e>=100&&e<1e3)return 2;if(e>=1e3&&e<1e4)return 3;e=Math.abs(e);var t=0,i=this.sign(e);if(e>1){for(;e>=1;)e=Math.floor(e/10),t++;return i*t-1}return e>0?Math.floor(Math.log(e)/Math.log(10)+1)-1:1}}],(i=null)&&r(t.prototype,i),n&&r(t,n),e}();function h(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}!function(e){e.None="none",e.Rhomb="rhomb",e.Circle="circle",e.Rect="rect"}(s||(s={})),function(e){e.None="none",e.Triangle="triangle",e.Rect="rect"}(l||(l={}));var u=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),h(this,"id",void 0),h(this,"snapsPerSeconds",5),h(this,"snapEnabled",!0),h(this,"snapAllKeyframesOnMove",!1),h(this,"timelineThicknessPx",2),h(this,"timelineMarginTopPx",15),h(this,"timelineCapWidthPx",4),h(this,"timelineCapHeightPx",10),h(this,"timelineCap",l.Rect),h(this,"timelineColor","DarkOrange"),h(this,"stepPx",120),h(this,"stepSmallPx",30),h(this,"smallSteps",50),h(this,"leftMarginPx",25),h(this,"headerFillColor","#101011"),h(this,"fillColor","#101011"),h(this,"labelsColor","#D5D5D5"),h(this,"tickColor","#D5D5D5"),h(this,"selectionColor","White"),h(this,"rowsStyle",{height:24,marginBottom:2,fillColor:"#252526",stripeFillColor:"#094771",stripeHeight:"auto",keyframesStyle:{fillColor:"red",shape:s.Rhomb,selectedFillColor:"DarkOrange",strokeColor:"Black",strokeThickness:.2,draggable:!0}}),h(this,"headerHeight",30),h(this,"ticksFont","11px sans-serif"),h(this,"zoom",1e3),h(this,"zoomSpeed",.1),h(this,"zoomMin",80),h(this,"zoomMax",8e3),h(this,"controlKeyIsMetaKey",!1),h(this,"scrollContainerClass","scroll-container"),h(this,"stripesDraggable",!0),h(this,"keyframesDraggable",!0)};function f(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var d,v=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),f(this,"autoPanSpeed",50),f(this,"scrollByDragSpeed",.12),f(this,"clickDetectionMs",120),f(this,"doubleClickTimeoutMs",400),f(this,"scrollFinishedTimeoutMs",500)};function m(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}!function(e){e.Alias="alias",e.AllScroll="all-scroll",e.Auto="auto",e.Cell="cell",e.ContextMenu="context-menu",e.ColResize="col-resize",e.Copy="copy",e.Crosshair="crosshair",e.Default="default",e.EResize="e-resize",e.EWResize="ew-resize",e.Grab="grab",e.Grabbing="grabbing",e.Help="help",e.Move="move",e.NResize="n-resize",e.NEResize="ne-resize",e.NESWResize="nesw-resize",e.NSResize="ns-resize",e.NWResize="nw-resize",e.NWSEResize="nwse-resize",e.NoDrop="no-drop",e.None="none",e.NotAllowed="not-allowed",e.Pointer="pointer",e.Progress="progress",e.RowResize="row-resize",e.SResize="s-resize",e.SEResize="se-resize",e.SWResize="sw-resize",e.Text="text",e.WResize="w-resize",e.Wait="wait",e.ZoomIn="zoom-in",e.ZoomOut="zoom-out"}(d||(d={}));var y,p,g,x=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i,n;return t=e,n=[{key:"getKeyframeStyle",value:function(e,t,i,n,o){if(e&&e){var r=e;if(void 0!==r[n])return r[n]}if(t&&t.keyframesStyle){var s=t.keyframesStyle;if(void 0!==s[n])return s[n]}if(i&&i.keyframesStyle){var l=i.keyframesStyle;if(void 0!==l[n])return l[n]}return o}},{key:"getRowStyle",value:function(e,t,i,n){if(e){var o=e;if(void 0!==o[i])return o[i]}if(t){var r=t;if(void 0!==r[i])return r[i]}return n}},{key:"getRowHeight",value:function(t,i){return e.getRowStyle(t,i,"height",24)}},{key:"rowStripeHeight",value:function(t,i){return e.getRowStyle(t,i,"stripeHeight","auto")}},{key:"stripeFillColor",value:function(t,i){return e.getRowStyle(t,i,"stripeFillColor")}},{key:"getRowMarginBottom",value:function(t,i){return e.getRowStyle(t,i,"marginBottom",0)}}],(i=null)&&m(t.prototype,i),n&&m(t,n),e}();function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=M(e);if(t){var o=M(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return C(this,i)}}function C(e,t){return!t||"object"!==w(t)&&"function"!=typeof t?P(e):t}function P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function T(e,t,i){return(T="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=M(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(i):o.value}})(e,t,i||e)}function M(e){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function R(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}!function(e){e.keyframe="keyframe",e.keyframes="keyframes",e.timeline="timeline"}(y||(y={})),function(e){e.Selected="selected",e.TimeChanged="timechanged",e.DragStarted="dragstarted",e.Drag="drag",e.DragFinished="dragfinished",e.Scroll="scroll",e.DoubleClick="doubleclick",e.MouseDown="mousedown"}(p||(p={})),function(e){e.Selection="selection",e.Pan="pan"}(g||(g={}));var E=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(r,e);var t,i,n,o=b(r);function r(e,t){var i,n,s,l;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),R(P(l=o.call(this)),"container",null),R(P(l),"canvas",null),R(P(l),"scrollContainer",null),R(P(l),"scrollContent",null),R(P(l),"ctx",null),R(P(l),"options",null),R(P(l),"startPos",null),R(P(l),"scrollStartPos",{x:0,y:0}),R(P(l),"currentPos",null),R(P(l),"selectionRect",null),R(P(l),"selectionRectEnabled",!1),R(P(l),"drag",null),R(P(l),"startedDragWithCtrl",!1),R(P(l),"startedDragWithShiftKey",!1),R(P(l),"clickTimeout",0),R(P(l),"lastClickTime",0),R(P(l),"consts",new v),R(P(l),"scrollFinishedTimerRef",null),R(P(l),"selectedKeyframes",[]),R(P(l),"val",0),R(P(l),"pixelRatio",1),R(P(l),"currentZoom",0),R(P(l),"intervalRef",null),R(P(l),"autoPanLastActionDate",0),R(P(l),"isPanStarted",!1),R(P(l),"interactionMode",g.Selection),R(P(l),"lastUsedArgs",null),R(P(l),"model",void 0),R(P(l),"handleBlurEvent",(function(){l.cleanUpSelection()})),R(P(l),"handleWindowResizeEvent",(function(){l.rescale(),l.redraw()})),R(P(l),"handleDocumentKeydownEvent",(function(e){if(65===e.which&&l.controlKeyPressed(e))return l.performSelection(!0),e.preventDefault(),!1})),R(P(l),"handleScrollEvent",(function(e){l.clearScrollFinishedTimer(),l.scrollFinishedTimerRef=setTimeout((function(){l.isPanStarted||(l.scrollFinishedTimerRef&&(clearTimeout(l.scrollFinishedTimerRef),l.scrollFinishedTimerRef=null),l.rescale(),l.redraw())}),l.consts.scrollFinishedTimeoutMs),l.redraw();var t=e||{};t.scrollLeft=l.scrollContainer.scrollLeft,t.scrollTop=l.scrollContainer.scrollTop,t.scrollHeight=l.scrollContainer.scrollHeight,t.scrollWidth=l.scrollContainer.scrollWidth,T((i=P(l),M(r.prototype)),"emit",i).call(i,p.Scroll,t)})),R(P(l),"handleWheelEvent",(function(e){if(l.controlKeyPressed(e)){if(e.preventDefault(),l.options.zoomSpeed>0&&l.options.zoomSpeed<=1){var t=l.getMousePos(l.canvas,e).x;t<=0&&(t=0);var i=l.pxToVal(l.scrollContainer.scrollLeft+t,!1),n=l.canvas.clientWidth/t,o=c.sign(e.deltaY)*l.options.zoom*l.options.zoomSpeed;l.currentZoom+=o,l.currentZoom>l.options.zoomMax&&(l.currentZoom=l.options.zoomMax),l.currentZoom<l.options.zoomMin&&(l.currentZoom=l.options.zoomMin);var r=l.valToPx(i,!0),s=Math.round(r-l.canvas.clientWidth/n);s<=0&&(s=0),l.rescale(s+l.canvas.clientWidth,null,"zoom"),l.scrollContainer.scrollLeft!=s&&(l.scrollContainer.scrollLeft=s),l.redraw()}}else l.scrollContainer.scrollTop+=e.deltaY,e.preventDefault()})),R(P(l),"handleMouseDownEvent",(function(e){var t=Date.now()-l.lastClickTime<l.consts.doubleClickTimeoutMs;l.lastClickTime=Date.now(),c.clearBrowserSelection(),l.startPos=l.trackMousePos(l.canvas,e),l.scrollStartPos={x:l.scrollContainer.scrollLeft,y:l.scrollContainer.scrollTop},t?T((n=P(l),M(r.prototype)),"emit",n).call(n,p.DoubleClick,l.startPos):(T((s=P(l),M(r.prototype)),"emit",s).call(s,p.MouseDown,l.startPos),l.clickTimeout=Date.now(),l.currentPos=l.startPos,l.drag=l.getDraggable(l.currentPos),l.drag&&l.drag.type===y.keyframe&&(l.startedDragWithCtrl=l.controlKeyPressed(e),l.startedDragWithShiftKey=e.shiftKey,l.drag.keyframe.selected||l.controlKeyPressed(e)||e.shiftKey||l.performSelection(!0,l.drag.keyframe,"keyframe"),l.drag.keyframes=l.getSelectedKeyframes()),l.redraw())})),R(P(l),"handleMouseMoveEvent",(function(e){if(e?l.lastUsedArgs=e:e=l.lastUsedArgs,e){var t=e instanceof TouchEvent&&e.changedTouches&&e.changedTouches.length>0;if(l.currentPos=l.trackMousePos(l.canvas,e),!l.isPanStarted&&l.selectionRect&&l.clickTimeoutIsOver()&&(l.selectionRectEnabled=!0),e=e,l.startPos)if(1==e.buttons||t){var i=!1;if(l.drag&&!l.startedDragWithCtrl){var n=l.mousePosToVal(l.currentPos.x,!0);if(l.drag.type===y.timeline)i=l.setTimeInternal(n,"user")||i;else if((l.drag.type==y.keyframe||l.drag.type==y.keyframes)&&l.drag.keyframes){var o=Math.floor(n-l.drag.val);Math.abs(o)>0&&(l.drag.keyframes.forEach((function(e){if(l.options.snapAllKeyframesOnMove){var t=l.snapVal(e.val);i=l.setKeyframePos(e,t)||i}e.val+o<0&&(o=-e.val)})),Math.abs(o)>0&&l.drag.keyframes.forEach((function(e){var t=e.val+o;i=l.setKeyframePos(e,t)||i})),i&&(l.drag.changed||l.emit("dragStarted",{keyframes:l.drag.keyframes}),l.drag.changed=!0,l.drag.val+=o,l.emit("drag",{keyframes:l.drag.keyframes})))}}l.interactionMode!==g.Pan||l.drag?l.scrollBySelectionOutOfBounds(l.currentPos):(l.isPanStarted=!0,l.scrollByPan(l.startPos,l.currentPos,l.scrollStartPos)),l.redraw()}else l.cleanUpSelection(),l.redraw();else if(!t){var r=l.getDraggable(l.currentPos);if(l.setCursor("default"),r){var s=null;(s=r.type===y.keyframes?s||d.EWResize:"keyframe"==r.type?s||d.Pointer:s||d.EWResize)&&l.setCursor(s)}}t&&e.preventDefault()}})),R(P(l),"handleMouseUpEvent",(function(e){if(l.startPos){var t=l.trackMousePos(l.canvas,e);l.selectionRect&&l.selectionRect.height<=2&&l.selectionRect.width<=2||!l.clickTimeoutIsOver()||l.drag&&l.startedDragWithCtrl||l.drag&&l.startedDragWithShiftKey?l.performClick(t,e,l.drag):!l.drag&&l.selectionRect&&l.selectionRectEnabled&&l.performSelection(!0,l.selectionRect,"rectangle",e.shiftKey),l.cleanUpSelection(),l.redraw()}})),R(P(l),"redrawInternal",(function(){l.valToPx(l.val,!0)>l.scrollContainer.scrollWidth&&(l.rescale(),!l.isPanStarted&&l.drag&&l.drag.type!==y.timeline&&l.scrollLeft()),l.renderBackground(),l.renderRows(),l.renderHeaderBackground(),l.renderTicks(),l.renderKeyframes(),l.renderSelectionRect(),l.renderTimeline()}));var a=e.id;if(l.model=t,!a)throw new Error("Element cannot be empty. Should be string or DOM element.");if(l.options=l.mergeOptions(e),l.currentZoom=l.options.zoom,a instanceof HTMLElement?l.container=a:l.container=document.getElementById(a),!l.container)throw new Error("Element cannot be empty. Should be string or DOM element.");if(l.scrollContainer=document.createElement("div"),l.scrollContent=document.createElement("div"),l.canvas=document.createElement("canvas"),!l.canvas||!l.canvas.getContext)return console.log("Cannot initialize canvas context."),C(l,null);l.container.style.position="relative",l.canvas.style.cssText="image-rendering: -moz-crisp-edges;image-rendering: -webkit-crisp-edges;image-rendering: pixelated;image-rendering: crisp-edges;user-select: none;-webkit-user-select: none;-khtml-user-select: none;-moz-user-select: none;-o-user-select: none;user-select: none;touch-action: none;position: relative;-webkit-user-drag: none;-khtml-user-drag: none;-moz-user-drag: none;-o-user-drag: none;user-drag: none;padding: inherit",l.scrollContainer.classList.add(l.options.scrollContainerClass),l.scrollContainer.style.cssText="overflow: scroll;position: absolute;width:  100%;height:  100%;",l.scrollContent.style.width=l.scrollContent.style.height="100%",l.scrollContainer.appendChild(l.scrollContent),l.container.appendChild(l.scrollContainer);var h=l.scrollContainer.offsetWidth-l.scrollContent.clientWidth;return l.canvas.style.width=l.canvas.style.height="calc(100% -"+(h||17)+"px)",l.container.appendChild(l.canvas),l.options.fillColor&&(l.scrollContainer.style.background=l.options.fillColor),l.options.snapsPerSeconds=Math.max(0,Math.min(60,l.options.snapsPerSeconds||0)),l.ctx=l.canvas.getContext("2d"),l.subscribeOnEvents(),l.rescale(),l.redraw(),l}return t=r,(i=[{key:"subscribeOnEvents",value:function(){this.container.addEventListener("wheel",this.handleWheelEvent),this.scrollContainer&&this.scrollContainer.addEventListener("scroll",this.handleScrollEvent),window.addEventListener("blur",this.handleBlurEvent,!1),window.addEventListener("resize",this.handleWindowResizeEvent,!1),document.addEventListener("keydown",this.handleDocumentKeydownEvent,!1),this.canvas.addEventListener("touchstart",this.handleMouseDownEvent,!1),this.canvas.addEventListener("mousedown",this.handleMouseDownEvent,!1),window.addEventListener("mousemove",this.handleMouseMoveEvent,!1),window.addEventListener("touchmove",this.handleMouseMoveEvent,!1),window.addEventListener("mouseup",this.handleMouseUpEvent,!1),window.addEventListener("touchend",this.handleMouseUpEvent,!1)}},{key:"dispose",value:function(){this._subscriptions=null,this.container=null,this.canvas=null,this.scrollContainer=null,this.scrollContent=null,this.ctx=null,this.cleanUpSelection(),this.container.removeEventListener("wheel",this.handleWheelEvent),this.scrollContainer&&this.scrollContainer.removeEventListener("scroll",this.handleScrollEvent),window.removeEventListener("blur",this.handleBlurEvent),window.removeEventListener("resize",this.handleWindowResizeEvent),document.removeEventListener("keydown",this.handleDocumentKeydownEvent),this.canvas.removeEventListener("touchstart",this.handleMouseDownEvent),this.canvas.removeEventListener("mousedown",this.handleMouseDownEvent),window.removeEventListener("mousemove",this.handleMouseMoveEvent),window.removeEventListener("touchmove",this.handleMouseMoveEvent),window.removeEventListener("mouseup",this.handleMouseUpEvent),window.removeEventListener("touchend",this.handleMouseUpEvent),this.stopAutoPan(),this.clearScrollFinishedTimer()}},{key:"clearScrollFinishedTimer",value:function(){this.scrollFinishedTimerRef&&(clearTimeout(this.scrollFinishedTimerRef),this.scrollFinishedTimerRef=null)}},{key:"performClick",value:function(e,t,i){var n=!1;if(i&&i.type===y.keyframe){var o=!0;if((this.startedDragWithCtrl&&this.controlKeyPressed(t)||this.startedDragWithShiftKey&&t.shiftKey)&&this.controlKeyPressed(t)&&(o=!i.keyframe.selected),n=this.performSelection(o,this.drag.keyframe,"keyframe",this.controlKeyPressed(t)||t.shiftKey)||n,t.shiftKey){var r=this.mousePosToVal(e.x,!0);n=this.setTimeInternal(r,"user")||n}}else n=this.performSelection(!1)||n,n=this.setTimeInternal(this.mousePosToVal(e.x,!0),"user")||n;return n}},{key:"setKeyframePos",value:function(e,t){return t=Math.floor(t),!(!e||e.val==t||(e.val=t,0))}},{key:"setCursor",value:function(e){this.canvas.style.cursor!=e&&(this.canvas.style.cursor=e)}},{key:"setInteractionMode",value:function(e){this.interactionMode!=e&&(this.interactionMode=e,this.cleanUpSelection())}},{key:"getSelectedKeyframes",value:function(){var e=this;return this.selectedKeyframes||(this.selectedKeyframes=[]),this.selectedKeyframes.length=0,this.forEachKeyframe((function(t){t&&t.selected&&e.selectedKeyframes.push(t)})),this.selectedKeyframes}},{key:"performSelection",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all",o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=!1;"all"==n&&(t||(t=!1),r=t),this.selectedKeyframes.length=0;var s=!0;return this.forEachKeyframe((function(l,a,h){var u=e.getKeyframePosition(l,h);u&&("keyframe"==n&&i===l||"rectangle"==n&&i&&c.isOverlap(u.x,u.y,i)?(l.selected!=t&&(l.selected=t,s=!0),l.selected&&e.selectedKeyframes.push(l)):o||l.selected==r||(l.selected=r,s=r))})),s&&this.emitKeyframesSelected(this.selectedKeyframes),s}},{key:"forEachKeyframe",value:function(e){if(this.model){var t=this.calculateRowsBounds(!1);t&&t.rows.forEach((function(t,i){if(t){var n=t.row;if(n&&n.keyframes&&Array.isArray(n.keyframes)&&!(n.keyframes.length<=0)){var o=!0;n.keyframes.filter((function(e){return e&&!e.hidden})).forEach((function(n,r){e&&n&&e(n,r,t,i,o),o=!1}))}}}))}}},{key:"trackMousePos",value:function(e,t){var i=this.getMousePos(e,t);if(i.val=this.pxToVal(i.x+this.scrollContainer.scrollLeft),i.snapVal=this.snapVal(i.val),this.startPos){this.selectionRect||(this.selectionRect={});var n=Math.floor(this.startPos.x+(this.scrollStartPos.x-this.scrollContainer.scrollLeft)),o=Math.floor(this.startPos.y+(this.scrollStartPos.y-this.scrollContainer.scrollTop));this.selectionRect.x=Math.min(n,i.x),this.selectionRect.y=Math.min(o,i.y),this.selectionRect.width=Math.max(n,i.x)-this.selectionRect.x,this.selectionRect.height=Math.max(o,i.y)-this.selectionRect.y}return i}},{key:"cleanUpSelection",value:function(){this.drag&&this.drag.changed&&this.emit(p.DragFinished,{keyframes:this.drag.keyframes}),this.startPos=null,this.drag=null,this.startedDragWithCtrl=!1,this.startedDragWithShiftKey=!1,this.selectionRect=null,this.clickTimeout=null,this.scrollStartPos=null,this.isPanStarted=!1,this.stopAutoPan()}},{key:"clickTimeoutIsOver",value:function(){return!!(this.clickTimeout&&Date.now()-this.clickTimeout>this.consts.clickDetectionMs)}},{key:"startAutoPan",value:function(){var e=this;this.consts.autoPanSpeed&&(this.intervalRef||(this.intervalRef=setInterval((function(){e.handleMouseMoveEvent(null)}),this.consts.autoPanSpeed)))}},{key:"stopAutoPan",value:function(){this.intervalRef&&(clearInterval(this.intervalRef),this.intervalRef=null),this.autoPanLastActionDate=null}},{key:"checkUpdateSpeedTooFast",value:function(){return!!(this.autoPanLastActionDate&&Date.now()-this.autoPanLastActionDate<=10)||(this.autoPanLastActionDate=Date.now(),!1)}},{key:"scrollByPan",value:function(e,t,i){if(e&&t){var n=Math.round(e.x-t.x),o=i.x+n;n>0&&this.rescale(o+this.canvas.clientWidth),n>0&&o+this.canvas.clientWidth>=this.scrollContainer.scrollWidth-5?this.scrollContainer.scrollLeft=this.scrollContainer.scrollWidth:this.scrollContainer.scrollLeft=o,this.scrollContainer.scrollTop=Math.round(e.y-t.y)}}},{key:"scrollBySelectionOutOfBounds",value:function(e){var t=e.x,i=e.y,n=!1,o=0,r=0,s=t<=0,l=t>=this.canvas.clientWidth,a=i<=0,h=i>=this.canvas.clientHeight,u=null,f=null;if(s||l||a||h){if(this.startAutoPan(),this.checkUpdateSpeedTooFast())return!1;var d=isNaN(this.consts.scrollByDragSpeed)?1:this.consts.scrollByDragSpeed;s?o=-c.getDistance(t,0)*d:l&&(o=c.getDistance(t,this.canvas.clientWidth)*d,u=this.scrollContainer.scrollLeft+this.canvas.clientWidth+o),a?r=-c.getDistance(t,0)*d/4:h&&(r=c.getDistance(t,this.canvas.clientHeight)*d/4,f=this.scrollContainer.scrollTop+this.canvas.clientHeight)}else this.stopAutoPan();return(u||f)&&this.rescale(u,f,"scrollBySelection"),Math.abs(o)>0&&(this.scrollContainer.scrollLeft+=o,n=!0),Math.abs(r)>0&&(this.scrollContainer.scrollTop+=r,n=!0),n}},{key:"pxToVal",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t||(e-=this.options.leftMarginPx);var i=e/this.options.stepPx*this.options.zoom;return i}},{key:"valToPx",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t){var i=this.scrollContainer.scrollLeft;e-=this.pxToVal(i)}return e*this.options.stepPx/this.options.zoom}},{key:"snapVal",value:function(e){if(this.options.snapsPerSeconds&&this.options.snapEnabled){var t=1e3/this.options.snapsPerSeconds,i=e/t,n=Math.round(i);e=Math.round(n*t)}return e<0&&(e=0),e}},{key:"mousePosToVal",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.pxToVal(this.scrollContainer.scrollLeft+Math.min(e,this.canvas.clientWidth));return i=Math.round(i),t&&(i=this.snapVal(i)),i}},{key:"formatLineGaugeText",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=e/1e3;t&&(i=e);var n=Math.floor(i/31536e3);i%=31536e3;var o=Math.floor(i/86400);i%=86400;var r=Math.floor(i/3600);i%=3600;var s=Math.floor(i/60);i%=60;var l="";return n&&(l+=n+":"),o&&(l+=o+":"),r&&(l+=r+":"),s&&(l+=s+":"),isNaN(i)||(l+=i),l}},{key:"renderTicks",value:function(){this.ctx.save();var e=this.scrollContainer.scrollWidth-this.options.leftMarginPx,t=this.pxToVal(0),i=this.pxToVal(e),n=c.getDistance(t,i);if(0!==n){var o=n/(e/this.options.stepPx),r=c.findGoodStep(o);if(0!=r&&!isNaN(r)&&isFinite(r)){var s=r/(e/(n/r)/this.options.stepSmallPx),l=c.findGoodStep(s,r);r%l!=0&&(l=s);var a=this.pxToVal(this.scrollContainer.scrollLeft+this.options.leftMarginPx),h=this.pxToVal(this.scrollContainer.scrollLeft+this.scrollContainer.clientWidth);t=Math.floor(a/r)*r,i=Math.ceil(h/r)*r+r;for(var u=null,f=t;f<=i;f+=r){var d=this.valToPx(f),v=this.getSharp(Math.round(d));this.ctx.save(),this.ctx.beginPath(),this.ctx.setLineDash([4]),this.ctx.lineWidth=1,this.ctx.strokeStyle=this.options.tickColor,c.drawLine(this.ctx,v,(this.options.headerHeight||0)/2,v,this.canvas.clientHeight),this.ctx.stroke(),this.ctx.fillStyle=this.options.labelsColor,this.options.ticksFont&&(this.ctx.font=this.options.ticksFont);var m=this.formatLineGaugeText(f),y=this.ctx.measureText(m),p=v-y.width/2;(isNaN(u)||u<=p)&&(u=p+y.width,this.ctx.fillText(m,p,10)),this.ctx.restore();for(var g=f+l;g<f+r;g+=l){var x=this.valToPx(g),w=this.getSharp(Math.floor(x));this.ctx.beginPath(),this.ctx.lineWidth=this.pixelRatio,this.ctx.strokeStyle=this.options.tickColor,c.drawLine(this.ctx,w,(this.options.headerHeight||0)/1.3,w,this.options.headerHeight),this.ctx.stroke()}}this.ctx.restore()}}}},{key:"calculateRowsBounds",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i={rows:[],area:{x:0,y:0,width:0,height:0},minValue:null,maxValue:null};if(!this.model)return i;var n=this.model.rows;if(!n||!Array.isArray(n)||n.length<=0)return i;var o=this.options.headerHeight;return n.filter((function(e){return e&&!e.hidden})).forEach((function(n,r){if(n){var s=x.getRowHeight(n,e.options.rowsStyle),l=x.getRowMarginBottom(n,e.options.rowsStyle),a=(o+=s+l)-e.scrollContainer.scrollTop;0==r&&(i.area.y=a),i.area.height=Math.max(o+s,i.area.height);var c={x:0,y:a,width:e.canvas.clientWidth,height:s,marginBottom:l,row:n,index:r,minValue:null,maxValue:null};if(i.rows.push(c),t||n.keyframes&&n.keyframes.forEach&&!(n.keyframes.length<=0)){if(n&&n.keyframes&&n.keyframes.forEach((function(e){var t=e.val;e&&!isNaN(t)&&(c.minValue=null==c.minValue?t:Math.min(t,c.minValue),c.maxValue=null==c.maxValue?t:Math.max(t,c.maxValue))})),!isNaN(c.minValue)&&!isNaN(c.maxValue)){var h=e.getKeyframesStripeSize(n,c.y,c.minValue,c.maxValue);c.stripeRect=h}null!==i.minValue&&null!==c.minValue?i.minValue=Math.min(c.minValue,i.minValue):null!==c.minValue&&(i.minValue=c.minValue),null!==i.maxValue&&null!==c.maxValue?i.maxValue=Math.min(c.maxValue,i.maxValue):null!==c.maxValue&&(i.maxValue=c.maxValue)}}})),null!==i.maxValue&&(i.area.width=this.valToPx(i.maxValue,!0)),i}},{key:"renderRows",value:function(){var e=this,t=this.calculateRowsBounds();t&&t.rows&&(this.ctx.save(),t.rows.forEach((function(t){if(t){e.ctx.fillStyle=x.getRowStyle(t.row,e.options.rowsStyle,"fillColor","#252526");var i=e.cutBounds(t);i&&e.ctx.fillRect(i.x,i.y,i.width,i.height);var n=x.stripeFillColor(t.row,e.options.rowsStyle);if(!(t.row.keyframes&&t.row.keyframes.length<=1)&&n){var o=e.cutBounds(t.stripeRect);o&&(e.ctx.fillStyle=n,e.ctx.fillRect(o.x,o.y,o.width,o.height))}}})),this.ctx.restore())}},{key:"cutBounds",value:function(e){if(!e)return null;var t=this.canvas.clientWidth,i=this.options.headerHeight||0,n=this.canvas.clientWidth;if(c.isRectOverlap(e,{x:0,y:i,width:c.getDistance(0,t),height:c.getDistance(i,n)})){var o=Math.max(e.y,i),r=Math.max(e.x,0),s=e.x-r,l=e.y-o;return{height:e.height+l,width:e.width+s,x:r,y:o,overlapY:Math.abs(l)>0,overlapX:Math.abs(s)>0}}return null}},{key:"getKeyframesStripeSize",value:function(e,t,i,n){var o=x.rowStripeHeight(e,this.options.rowsStyle),r=x.getRowHeight(e,this.options.rowsStyle);(!o&&0!==o||isNaN(o)||"auto"==o)&&(o=Math.floor(.8*r)),o>r&&(o=r);var s=r-o,l=this.valToPx(i),a=this.valToPx(n);return{x:l,y:t+Math.floor(s/2),height:o,width:c.getDistance(l,a)}}},{key:"getKeyframePosition",value:function(e,t){if(!e)return console.log("keyframe should be defined."),null;var i=e.val;if(isNaN(i))return null;var n,o=t.y+t.height/2-this.scrollContainer.scrollTop;return(n=t.height/3)>0&&!isNaN(i)?{x:Math.floor(this.valToPx(i)),y:Math.floor(o),height:n,width:n}:null}},{key:"renderKeyframes",value:function(){var e=this;this.forEachKeyframe((function(t,i,n){var o=n.row,r=e.getKeyframePosition(t,n);if(r){var l=e.getSharp(r.x),a=r.y,c=r.height,h=e.cutBounds({x:l-c/2,y:a-c/2,width:c,height:c});if(!h)return;e.ctx.save(),h&&h.overlapY&&(e.ctx.beginPath(),e.ctx.rect(0,e.options.headerHeight||0,e.canvas.clientWidth,e.canvas.clientWidth),e.ctx.clip());var u=x.getKeyframeStyle(t,o,e.options.rowsStyle,"shape",s.Rhomb);if(u===s.None)return;var f=x.getKeyframeStyle(t,o,e.options.rowsStyle,t.selected?"fillColor":"selectedFillColor",t.selected?"red":"DarkOrange"),d=x.getKeyframeStyle(t,o,e.options.rowsStyle,"strokeThickness",.2),v=d>0?x.getKeyframeStyle(t,o,e.options.rowsStyle,"strokeColor","Black"):"";u==s.Rhomb?(e.ctx.beginPath(),e.ctx.translate(l,a),e.ctx.rotate(45*Math.PI/180),d>0&&v&&(e.ctx.fillStyle=v,e.ctx.rect(-c/2,-c/2,c,c),e.ctx.fill()),e.ctx.fillStyle=f,e.ctx.translate(d,d),e.ctx.rect(-c/2,-c/2,c-2*d,c-2*d),e.ctx.fill()):u==s.Circle?(e.ctx.beginPath(),d>0&&v&&(e.ctx.fillStyle=v,e.ctx.arc(l,a,c,0,2*Math.PI)),e.ctx.fillStyle=f,e.ctx.arc(l,a,c-d,0,2*Math.PI),e.ctx.fill()):u==s.Rect&&(e.ctx.beginPath(),a-=c/2,l-=c/2,d>0&&v&&(e.ctx.fillStyle=v,e.ctx.rect(l,a,c,c),e.ctx.fill()),e.ctx.fillStyle=f,e.ctx.rect(l+d,a+d,c-d,c-d),e.ctx.fill()),e.ctx.restore()}}))}},{key:"renderSelectionRect",value:function(){this.drag||(this.ctx.save(),this.selectionRect&&this.selectionRectEnabled&&(this.ctx.setLineDash([4]),this.ctx.lineWidth=this.pixelRatio,this.ctx.strokeStyle=this.options.selectionColor,this.ctx.strokeRect(this.getSharp(this.selectionRect.x,1),this.getSharp(this.selectionRect.y,1),Math.floor(this.selectionRect.width),Math.floor(this.selectionRect.height))),this.ctx.restore())}},{key:"renderBackground",value:function(){this.options.fillColor?(this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(0,0,this.canvas.clientWidth,this.canvas.clientHeight),this.ctx.fillStyle=this.options.fillColor,this.ctx.fill(),this.ctx.restore()):this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}},{key:"renderTimeline",value:function(){this.ctx.save();var e=this.options.timelineThicknessPx;this.ctx.lineWidth=e*this.pixelRatio;var t=this.getSharp(Math.round(this.valToPx(this.val)),e);this.ctx.strokeStyle=this.options.timelineColor,this.ctx.fillStyle=this.ctx.strokeStyle;var i=this.options.timelineMarginTopPx;if(this.ctx.beginPath(),c.drawLine(this.ctx,t,i,t,this.canvas.clientHeight),this.ctx.stroke(),this.options.timelineCapWidthPx&&this.options.timelineCapHeightPx){var n=this.options.timelineCapWidthPx,o=this.options.timelineCapHeightPx;this.options.timelineCap===l.Triangle?(this.ctx.beginPath(),this.ctx.moveTo(t-n/2,i),this.ctx.lineTo(t+n/2,i),this.ctx.lineTo(t,o),this.ctx.closePath(),this.ctx.stroke()):this.options.timelineCap===l.Rect&&(this.ctx.fillRect(t-n/2,i,n,o),this.ctx.fill())}this.ctx.restore()}},{key:"renderHeaderBackground",value:function(){!isNaN(this.options.headerHeight)&&this.options.headerHeight>0&&(this.ctx.save(),this.ctx.lineWidth=this.pixelRatio,this.options.headerFillColor?(this.ctx.lineWidth=this.pixelRatio,this.ctx.fillStyle=this.options.headerFillColor,this.ctx.fillRect(0,0,this.canvas.clientWidth,this.options.headerHeight)):this.ctx.clearRect(0,0,this.canvas.clientWidth,this.options.headerHeight),this.ctx.restore())}},{key:"redraw",value:function(){window.requestAnimationFrame?window.requestAnimationFrame(this.redrawInternal):this.redrawInternal()}},{key:"scrollLeft",value:function(){this.scrollContainer.scrollLeft!=this.scrollContainer.scrollWidth&&(this.scrollContainer.scrollLeft=this.scrollContainer.scrollWidth)}},{key:"getSharp",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t%2==0?e:e+this.pixelRatio/2}},{key:"getTime",value:function(){return this.val}},{key:"setTimeInternal",value:function(e,t){return(e=Math.round(e))<0&&(e=0),this.val==e||(this.val=e,this.emit("timeChanged",{val:e,source:t}),!0)}},{key:"setTime",value:function(e){return(!this.drag||this.drag.type!==y.timeline)&&this.setTimeInternal(e,"setTime")}},{key:"select",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.performSelection(e),this.redraw()}},{key:"getOptions",value:function(){return this.options}},{key:"controlKeyPressed",value:function(e){return this.options.controlKeyIsMetaKey||this.options.controlKeyIsMetaKey?e.metaKey:e.ctrlKey}},{key:"emitKeyframesSelected",value:function(e){this.emit(p.Selected,{keyframes:e})}},{key:"setScrollLeft",value:function(e){this.scrollContainer&&(this.scrollContainer.scrollLeft=e)}},{key:"setScrollTop",value:function(e){this.scrollContainer&&(this.scrollContainer.scrollTop=e)}},{key:"getScrollLeft",value:function(){return this.scrollContainer?this.scrollContainer.scrollLeft:0}},{key:"getScrollTop",value:function(){return this.scrollContainer?this.scrollContainer.scrollTop:0}},{key:"onScroll",value:function(e){this.on(p.Scroll,e)}},{key:"setOptions",value:function(e){return this.options=this.mergeOptions(e),this.rescale(),this.redraw(),this.options}},{key:"getModel",value:function(){return this.model}},{key:"setModel",value:function(e){this.model=e,this.rescale(),this.redraw()}},{key:"getMousePos",value:function(e,t){var i=1,n=0,o=0;if(t instanceof TouchEvent){var r=t;if(r.changedTouches&&r.changedTouches.length>0){var s=t.changedTouches[0];n=s.clientX,o=s.clientY,i=Math.max(i,s.radiusX,s.radiusY)}}else n=t.clientX,o=t.clientY;var l=e.getBoundingClientRect(),a=e.width/this.pixelRatio/l.width,c=e.height/this.pixelRatio/l.height;return{x:(n-l.left)*a,y:(o-l.top)*c,radius:i}}},{key:"rescaleCanvas",value:function(){var e=!1,t=this.scrollContainer.clientWidth*this.pixelRatio,i=this.scrollContainer.clientHeight*this.pixelRatio;return Math.floor(t)!=Math.floor(this.ctx.canvas.width)&&(this.ctx.canvas.width=t,e=!0),Math.floor(i)!=Math.floor(this.ctx.canvas.height)&&(this.ctx.canvas.height=i,e=!0),this.ctx.setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0),e}},{key:"rescale",value:function(e,t,i){this.rescaleCanvas();var n=this.calculateRowsBounds();if(n&&n.area){var o=this.options.stepPx;e=e||0;var r=this.valToPx(this.val,!0),s=0;r>this.canvas.clientWidth&&(s="scrollBySelection"==i?Math.floor(r+this.canvas.clientWidth+(this.options.stepPx||0)):Math.floor(r+this.canvas.clientWidth/1.5));var l=n.area.width+this.options.leftMarginPx+o;e=Math.max(e,l,this.scrollContainer.scrollLeft+this.canvas.clientWidth,s);var a=Math.floor(e)+"px";a!=this.scrollContent.style.minWidth&&(this.scrollContent.style.minWidth=a);var c=(t=Math.max(Math.floor(n.area.height+.2*this.canvas.clientHeight),this.scrollContainer.scrollTop+this.canvas.clientHeight-1,Math.round(t||0)))+"px";this.scrollContent.style.minHeight!=c&&(this.scrollContent.style.minHeight=c)}}},{key:"getDraggable",value:function(e){var t=this,i=Math.max(2,e.radius),n=null,o=Number.MAX_SAFE_INTEGER;if(e.y>=this.options.headerHeight&&this.options.keyframesDraggable){if(this.forEachKeyframe((function(r,s,l){if(void 0===r.draggable||r.draggable){var a=t.getKeyframePosition(r,l);if(a){var h=c.getDistance(a.x,a.y,e.x,e.y);h<=a.height+i&&(n?h<=o&&(n.keyframe=r,n.val=r.val):(o=h,n={keyframe:r,val:r.val,type:y.keyframe}))}}})),n)return n;var r=this.calculateRowsBounds();if(this.options.stripesDraggable&&r){var s=null;if(r.rows)for(var l=0;l<r.rows.length;l++){var a=r.rows[l];if(!a)break;if(!x.getRowStyle(a.row,this.options.rowsStyle,"stripeDraggable",!0))break;c.isOverlap(e.x,e.y,a.stripeRect)&&(s=a)}if(s){if((n={type:y.keyframes}).val=this.mousePosToVal(e.x,!0),s.row&&s.row.keyframes){n.keyframes=s.row.keyframes;var h=this.snapVal(s.minValue);n.val+=s.minValue-h}return n}}}var u=this.valToPx(this.val),f=Math.max((this.options.timelineThicknessPx||1)*this.pixelRatio,this.options.timelineCapWidthPx*this.pixelRatio||1)+i;if(e.y<=this.options.headerHeight||e.x>=u-f/2&&e.x<=u+f/2)return{val:this.val,type:y.timeline}}},{key:"mergeOptions",value:function(e){e=e||{};var t=new u;return function e(t,i){if(t&&i)for(var n in t)Object.prototype.hasOwnProperty.call(i,n)&&(null==t[n]?t[n]=i[n]:"object"===w(t[n])&&e(t[n],i[n]))}(t,e),t}}])&&k(t.prototype,i),n&&k(t,n),r}(o);var D=function e(){var t,i,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n=[],(i="rows")in(t=this)?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n},W=i(0),K=i(1),L=i(2),z=i(3),O=i(4),V=i(5),B=i(6),H=i(7),N=i(8),F=i(9),A=i(10)}])}));